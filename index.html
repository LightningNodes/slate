
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <meta
            name="description"
            content="Documentation for the Pi42 APIs"
        >
    <title>Pi42 API Reference Documentation</title>

    <style media="screen">
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s, .highlight .sa, .highlight .dl {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf, .highlight .fm {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv, .highlight .vm {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .nl {
  color: #f92672;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <style media="print">
      * {
        -webkit-transition:none!important;
        transition:none!important;
      }
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #586e75;
}
.highlight .err {
  color: #002b36;
  background-color: #dc322f;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cm, .highlight .cpf, .highlight .c1, .highlight .cs {
  color: #657b83;
}
.highlight .cp {
  color: #b58900;
}
.highlight .nt {
  color: #b58900;
}
.highlight .o, .highlight .ow {
  color: #93a1a1;
}
.highlight .p, .highlight .pi {
  color: #93a1a1;
}
.highlight .gi {
  color: #859900;
}
.highlight .gd {
  color: #dc322f;
}
.highlight .gh {
  color: #268bd2;
  background-color: #002b36;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #6c71c4;
}
.highlight .kc {
  color: #cb4b16;
}
.highlight .kt {
  color: #cb4b16;
}
.highlight .kd {
  color: #cb4b16;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .dl, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #859900;
}
.highlight .sa {
  color: #6c71c4;
}
.highlight .sr {
  color: #2aa198;
}
.highlight .si {
  color: #d33682;
}
.highlight .se {
  color: #d33682;
}
.highlight .nn {
  color: #b58900;
}
.highlight .nc {
  color: #b58900;
}
.highlight .no {
  color: #b58900;
}
.highlight .na {
  color: #268bd2;
}
.highlight .m, .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mx {
  color: #859900;
}
.highlight .ss {
  color: #859900;
}
    </style>
    <link href="stylesheets/screen-9c19b03a.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-966d6edc.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-024da600.js"></script>

    <script>
      $(function() { setupCodeCopy(); });
    </script>
  </head>

  <body class="index" data-languages="[&quot;javascript&quot;,&quot;python&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar-cad8cdcb.png" alt="" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo-9176f612.png" class="logo" alt="" />
        <div class="lang-selector">
              <a href="#" data-language-name="javascript">javascript</a>
              <a href="#" data-language-name="python">python</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#change-log" class="toc-h1 toc-link" data-title="Change Log">Change Log</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#17-07-2024" class="toc-h2 toc-link" data-title="17-07-2024">17-07-2024</a>
                  </li>
                  <li>
                    <a href="#9-07-2024" class="toc-h2 toc-link" data-title="9-07-2024">9-07-2024</a>
                  </li>
                  <li>
                    <a href="#19-06-2024" class="toc-h2 toc-link" data-title="19-06-2024">19-06-2024</a>
                  </li>
                  <li>
                    <a href="#06-06-2024" class="toc-h2 toc-link" data-title="06-06-2024">06-06-2024</a>
                  </li>
                  <li>
                    <a href="#28-05-2024" class="toc-h2 toc-link" data-title="28-05-2024">28-05-2024</a>
                  </li>
                  <li>
                    <a href="#20-05-2024" class="toc-h2 toc-link" data-title="20-05-2024">20-05-2024</a>
                  </li>
                  <li>
                    <a href="#10-05-2024" class="toc-h2 toc-link" data-title="10-05-2024">10-05-2024</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#getting-started-with-pi42-apis" class="toc-h2 toc-link" data-title="Getting Started with Pi42 APIs">Getting Started with Pi42 APIs</a>
                  </li>
                  <li>
                    <a href="#get-request" class="toc-h2 toc-link" data-title="getRequest Function">getRequest Function</a>
                  </li>
                  <li>
                    <a href="#post-request" class="toc-h2 toc-link" data-title="postRequest Function">postRequest Function</a>
                  </li>
                  <li>
                    <a href="#put-request" class="toc-h2 toc-link" data-title="putRequest Function">putRequest Function</a>
                  </li>
                  <li>
                    <a href="#delete-request" class="toc-h2 toc-link" data-title="deleteRequest Function">deleteRequest Function</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#rate-limits" class="toc-h1 toc-link" data-title="API Rate Limits">API Rate Limits</a>
          </li>
          <li>
            <a href="#orders" class="toc-h1 toc-link" data-title="Orders">Orders</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#place-order" class="toc-h2 toc-link" data-title="Place an Order ">Place an Order </a>
                  </li>
                  <li>
                    <a href="#add-margin" class="toc-h2 toc-link" data-title=" Add Margin "> Add Margin </a>
                  </li>
                  <li>
                    <a href="#reduce-margin" class="toc-h2 toc-link" data-title="Reduce Margin">Reduce Margin</a>
                  </li>
                  <li>
                    <a href="#get-open-orders" class="toc-h2 toc-link" data-title="Get Open Orders">Get Open Orders</a>
                  </li>
                  <li>
                    <a href="#get-order-history" class="toc-h2 toc-link" data-title="Get Order History">Get Order History</a>
                  </li>
                  <li>
                    <a href="#get-linked-orders" class="toc-h2 toc-link" data-title="Get Linked Orders">Get Linked Orders</a>
                  </li>
                  <li>
                    <a href="#get-margin-history" class="toc-h2 toc-link" data-title="Fetch Margin History">Fetch Margin History</a>
                  </li>
                  <li>
                    <a href="#get-postions" class="toc-h2 toc-link" data-title="Get Positions">Get Positions</a>
                  </li>
                  <li>
                    <a href="#get-position-status" class="toc-h2 toc-link" data-title="Get Position Status">Get Position Status</a>
                  </li>
                  <li>
                    <a href="#trade-history" class="toc-h2 toc-link" data-title="Get User's Trade History">Get User's Trade History</a>
                  </li>
                  <li>
                    <a href="#get-transaction-history" class="toc-h2 toc-link" data-title="Get User's Transaction History">Get User's Transaction History</a>
                  </li>
                  <li>
                    <a href="#exchange-update-leverage" class="toc-h2 toc-link" data-title="Update Leverage">Update Leverage</a>
                  </li>
                  <li>
                    <a href="#delete-order" class="toc-h2 toc-link" data-title=" Deleting an Order"> Deleting an Order</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#public-endpoints" class="toc-h1 toc-link" data-title="Public Endpoints">Public Endpoints</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#ticker-update-24hr" class="toc-h2 toc-link" data-title="Ticker Update (24Hr)">Ticker Update (24Hr)</a>
                  </li>
                  <li>
                    <a href="#agg-trade-update" class="toc-h2 toc-link" data-title="Aggregate Trade Update">Aggregate Trade Update</a>
                  </li>
                  <li>
                    <a href="#depth-update" class="toc-h2 toc-link" data-title="Depth Update">Depth Update</a>
                  </li>
                  <li>
                    <a href="#klines" class="toc-h2 toc-link" data-title="Get Klines">Get Klines</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#web-sockets" class="toc-h1 toc-link" data-title="Web Sockets">Web Sockets</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#create-listen-key" class="toc-h2 toc-link" data-title=" Create Listen Key "> Create Listen Key </a>
                  </li>
                  <li>
                    <a href="#authenticated-web-sockets" class="toc-h2 toc-link" data-title="Authenticated Web Sockets">Authenticated Web Sockets</a>
                  </li>
                  <li>
                    <a href="#public-web-sockets" class="toc-h2 toc-link" data-title="Public Web Sockets">Public Web Sockets</a>
                  </li>
                  <li>
                    <a href="#get-listen-key" class="toc-h2 toc-link" data-title="Get Listen Key">Get Listen Key</a>
                  </li>
                  <li>
                    <a href="#update-listen-key" class="toc-h2 toc-link" data-title="Update Listen Key">Update Listen Key</a>
                  </li>
                  <li>
                    <a href="#delete-listen-key" class="toc-h2 toc-link" data-title="Delete Listen Key">Delete Listen Key</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#error-codes" class="toc-h1 toc-link" data-title=" Error Codes "> Error Codes </a>
          </li>
      </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <p><h1 id='change-log'>Change Log</h1><h2 id='17-07-2024'>17-07-2024</h2>
<ol>
<li>Added Enum Value GST_ON_Funding FEE in TransactionType</li>
<li>Exchange Info <br/></p>

<p><ul>
<li>Added optional query param <code>market</code></li>
<li>Added <code>markets</code>, <code>tags</code>, <code>assetPrecisions</code>, <code>conversionRates</code> in the response <br/></li>
<li>For each contract, from the response: <br/></p>

<p><ul>
<li> Removed: <code>marginAsset</code>, <code>maintMarginPercent</code> <br/></li>
<li> Added: <code>market</code>, <code>marginAssetsSupported</code>, <code>fundingFeeInterval</code> <br/></li>
</ul></li>
</ul></li>
<li>Open Orders, Order History, Linked Orders <br/></p>

<p><ul>
<li>Added <code>baseAsset</code>, <code>quoteAsset</code> in response <br/></li>
<li>Added <code>lockedMarginInMarginAsset</code>, <code>lockedMargin</code>, <code>stopPrice</code>, <code>marginAsset</code>, <code>leveragedQty</code> in Order History response <br/></li>
</ul></li>
<li>Add Margin/ Reduce Margin <br/></p>

<p><ul>
<li> Added <code>asset</code> in response <br/></li>
</ul></li>
<li>Get order using client order ID, Get order using ref ID <br/></p>

<p><ul>
<li>Added <code>lockedMarginInMarginAsset(optional)</code>, <code>baseAsset</code>, <code>quoteAsset</code>, <code>marginAsset</code> in response <br/></li>
</ul></li>
<li>Place Order <br/></p>

<p><ul>
<li> Added optional field <code>marginAsset</code> in body <br/></li>
<li>Added <code>lockedMarginInMarginAsset</code>, <code>baseAsset</code>, <code>quoteAsset</code>, <code>marginAsset</code> in response <br/></li>
</ul></li>
<li>Transaction History, Get Transaction using ID <br/></p>

<p><ul>
<li>Added baseAsset, quoteAsset in response <br/></li>
</ul></li>
<li>Trade History, Get Trade using ID <br/></p>

<p><ul>
<li>Added <code>baseAsset</code>, <code>quoteAsset</code> , <code>marginAsset</code>, <code>feeInMarginAsset(optional)</code>, <code>realizedProfitInMarginAsset</code>(optional) in
response</li>
</ul></li>
<li>Get Positions, Get Position using position id <br/></p>

<p><ul>
<li>Added baseAsset, quoteAsset , marginAsset, marginInMarginAsset(optional), realizedProfitInMarginAsset(optional) in
response</li>
</ul></li>
<li>Web Socket Updates <br/></p>

<p><ul>
<li>New Events Added:<br/></p>

<p><ul>
<li>Market Info ( marketInfo)<br/></li>
<li> Mark Price Stream for All market ( markPriceArr)<br/></li>
<li>All Market Tickers Streams( tickerArr)<br/></li>
</ul></li>
<li>Added new fields in the Response of following events <br/></p>

<p><ul>
<li>Order Events : <code>marginAsset</code>, <code>market</code> , <code>baseAsset</code>, <code>quoteAsset</code><br/></li>
<li>Position Events:<code>market</code>, <code>marginAsset</code>, <code>marginConversionRate</code>, <code>marginSettlementRate</code>, <code>marginInMarginAsset</code>,
<code>realizedProfitInMarginAsset</code> <br/></li>
<li>Trade Events: <code>feeInMarginAsset</code> <br/></li>
</ul></li>
</ul></li>
</ol>
<h2 id='9-07-2024'>9-07-2024</h2>
<ol>
<li>Pagination update of following APIs: <code>orderHistory</code>, <code>tradeHistory</code>, <code>transactionHistory</code>, <code>openOrders</code>, <code>positions</code></p>

<p><ul>
<li>Removed <code>timestamp</code> query param.</li>
<li>Added optional query params namely:</p>

<p><ul>
<li><code>startTimestamp</code> (lower bound) <br/></li>
<li> <code>endTimestamp</code> (upper bound) <br/></li>
<li> <code>sortOrder</code>(asc or desc) <br/></li>
</ul></li>
<li> Response: <code>nextTimestamp</code> which is used in the next paginated API call.</li>
<li>Examples added in the API descriptions section in the doc.</li>
</ul></li>
<li>New Endpoint </p>

<p><ul>
<li>Margin History ( GET /v1/order/fetch-margin-history)</li>
</ul></li>
</ol>
<h2 id='19-06-2024'>19-06-2024</h2>
<ol>
<li>Updated Pagination of following APIs: <code>orderHistory</code>, <code>tradeHistory</code>, <code>transactionHistory</code>, <code>openOrders</code></p>

<p><ul>
<li>Pagination changed from page basis to timestamp basis.</li>
<li>Introduced timestamp basis pagination in positions API.</li>
<li>Response gives a field <code>nextTimestamp</code>, which is used for next API call.</li>
</ul></li>
</ol>
<h2 id='06-06-2024'>06-06-2024</h2>
<ol>
<li>New Endpoints added</p>

<p><ul>
<li>Get Depth Update( GET <code>/v1/market/depth/:contractPair</code>)<br/></li>
<li>Get Aggregate trade update ( GET <code>/v1/market/aggTrade/:contractPair</code>)</li>
<li>Get order details using ref ID ( GET <code>/v1/order/ref-id</code>)</li>
<li>Get user id and account ID using ref ID ( GET <code>/v1/integration/user</code>)</li>
<li>Get fiat order details using reference ID ( GET <code>/v1/integration/fiat-order-details</code>)</li>
<li>Get 24hr ticker update ( GET <code>/v1/market/ticker24Hr/:contractPair</code>)</li>
<li>Get trade history based on trade ID ( GET <code>/v1/user-data/trade-history/{id}</code>)</li>
<li>Get transaction history based on transaction ID ( GET <code>/v1/user-data/transaction-history/{id}</code>)</li>
</ul></li>
<li>Updated Endpoints</p>

<p><ul>
<li>Two new optional query params( tradeId and positionId) added in ( GET <code>/v1/user-data/transaction-history</code>).</li>
<li>Updates in body of ( POST <code>/v1/integration/event-replay</code>)</li>
</ul></li>
<li>Added optional field refId in the responses of place order, get order details using <code>client order id</code>, <code>order history</code>, <code>open orders</code>, <code>linked
orders</code> endpoints.</li>
<li>Secure Web Socket Updates:
a. In each event, <code>eventTime</code> will be in nanoseconds and type will be string.</li>
</ol>
<h2 id='28-05-2024'>28-05-2024</h2>
<ol>
<li>New Endpoints <br/></p>

<p><ul>
<li> Get Order ( GET <code>/v1/order?clientOrderId=abc</code>)<br/></li>
<li>Get Position ( GET <code>/v1/positions?positionId=abc</code>)<br/></li>
<li>Event Replay ( POST <code>/v1/integration/event-replay</code>): This is just endpoint, we&#39;re still deploying the changes.<br/>
<br/></li>
</ul></li>
<li>Secure Web Socket Updates:<br/>
a. Added new event for Funding Fee named <strong>fundingFee</strong></li>
</ol>
<h2 id='20-05-2024'>20-05-2024</h2>
<ol>
<li>Added <code>lockedMargin</code> field in the <code>place-order</code> API response</li>
</ol>
<h2 id='10-05-2024'>10-05-2024</h2>
<ol>
<li>New Endpoint:
INR Deposit and Withdraw History ( GET <code>/v1/integration/deposit-withdraw-history</code>)</li>
<li>New enums: <code>PaymentType</code>, <code>PaymentStatus</code></li>
<li>Added optional query params for pagination for the following endpoints</p>

<p><ul>
<li>Order History</li>
<li>Open Orders</li>
<li>Transaction History</li>
<li>Trade History</li>
</ul></li>
<li>Updated public key sharing under Authenticated endpoints.</li>
<li>Secure Web Socket Updates:</p>

<p><ul>
<li>Added eventTime field in all the events.</li>
<li>Updated response of order events.
In case of orderPartiallyFilled event, use filledAmount instead of cumQty for total filled
quantity.
c. New Events:</li>
<li>Margin Call (marginCallAlert)</li>
<li>Liquidation ( liquidationAlert)</li>
<li>Trade stream (newTrade)</li>
</ul></li>
</ol></p>

<h1 id='introduction'>Introduction</h1>

<p>Pi42 offers a suite of public-facing APIs designed to facilitate integration with various applications and systems, particularly within the domains it specializes in. Here is a high-level introduction to the key features and functionalities of Pi42&#39;s public-facing APIs:</p>

<ol>
<li><p><strong>Authentication and Authorization</strong>:</p>

<ul>
<li><strong>OAuth 2.0 Support</strong>: Pi42 APIs utilize OAuth 2.0 for secure authentication and authorization, ensuring that only authorized users and applications can access the data.</li>
<li><strong>API Keys</strong>: For simpler integrations, Pi42 also supports API keys, allowing developers to authenticate their requests with a unique key.</li>
</ul></li>
<li><p><strong>Data Access and Management</strong>:</p>

<ul>
<li><strong>Data Retrieval</strong>: APIs provide endpoints for retrieving various types of data, such as user information, transaction history, and analytics reports.</li>
<li><strong>Data Insertion and Updates</strong>: Developers can use the APIs to insert new data or update existing records in the Pi42 system.</li>
<li><strong>Search and Filtering</strong>: Advanced search and filtering capabilities allow developers to query the data efficiently, using parameters like date ranges, status filters, and more.</li>
</ul></li>
<li><p><strong>Analytics and Reporting</strong>:</p>

<ul>
<li><strong>Real-time Analytics</strong>: Access real-time analytics data, enabling applications to display up-to-the-minute information.</li>
<li><strong>Custom Reports</strong>: APIs allow the generation of custom reports based on specified criteria, providing flexibility in data analysis.</li>
</ul></li>
<li><p><strong>Integration and Automation</strong>:</p>

<ul>
<li><strong>Webhooks</strong>: Pi42 supports webhooks, enabling real-time notifications and updates to be pushed to external systems.</li>
<li><strong>Batch Processing</strong>: For handling large volumes of data, batch processing endpoints are available, facilitating efficient data management.</li>
</ul></li>
<li><p><strong>Developer Resources</strong>:</p>

<ul>
<li><strong>Comprehensive Documentation</strong>: Detailed API documentation, including endpoint descriptions, request and response formats, error codes, and usage examples.</li>
<li><strong>SDKs and Libraries</strong>: Pi42 provides SDKs and libraries in various programming languages to simplify the integration process for developers.</li>
<li><strong>Sandbox Environment</strong>: A sandbox environment is available for developers to test their integrations without affecting live data.</li>
</ul></li>
<li><p><strong>Compliance and Security</strong>:</p>

<ul>
<li><strong>Data Encryption</strong>: All data transmitted via the APIs is encrypted to ensure security and privacy.</li>
<li><strong>Compliance</strong>: Pi42 APIs adhere to industry standards and regulations, such as GDPR and HIPAA, making them suitable for use in regulated industries like healthcare and finance.</li>
</ul></li>
</ol>

<h2 id='getting-started-with-pi42-apis'>Getting Started with Pi42 APIs</h2>

<p>APIs provided by Pi42 classifications ensure that only authorized users can access sensitive functionalities, while still allowing open access to non-sensitive information or system statuses.</p>

<h3 id='authenticated-apis'>Authenticated APIs</h3>

<p>The Authenticated endpoints require users to provide valid credentials before access is granted. These endpoints are secured, ensuring that only authorized users can interact with sensitive data or perform privileged operations. Authentication typically involves the use of tokens, API keys, or OAuth, which must be included in the request header. These endpoints are designed for operations that involve personal data, secure transactions, or actions that could impact the system&#39;s state or other users.</p>

<p>APIs that require trade permissions:</p>

<table>
<tr>
<td>/v1/order/place-order</td></tr>
<tr><td>/v1/order/delete-order</td></tr>
<tr><td>/v1/order/add-margin</td></tr>
<tr><td>/v1/order/reduce-margin</td></tr>
<tr><td>/v1/exchange/update/leverage</td></tr>
</table>

<h3 id='public-apis'>Public APIs</h3>

<p>The Public endpoints are accessible without any authentication, allowing open access to certain resources or information. These endpoints are designed to handle requests that do not require user identification or secure access, such as fetching general information, retrieving publicly available data, or providing status updates. While public, these endpoints are still subject to rate limiting and monitoring to prevent abuse or misuse of the system.</p>

<p>Endpoints which <strong>DO NOT</strong> require <code>api-key</code> and <code>signature</code> authentication:</p>

<table>
<tr>
<td>/v1/market/klines</td></tr>
<tr><td>/v1/market/depth</td></tr>
<tr><td>/v1/market/aggTrade</td></tr>
<tr><td>/v1/market/ticker24Hr</td></tr>
</table>

<aside class="notice"> 
Base URLs for: <br/>
- Authenticated endpoints: `https://fapi.pi42.com/` <br/>
- Public endpoints: `https://api.pi42.com/`
</aside>

<p>To begin using Pi42 Authenticated APIs, follow these steps:</p>

<ol>
<li><p>API Key Creation <br/>
Users can create an API key, which will be associated with a secret. The secret will be shown only once during the creation process.</p></li>
<li><p>Signature Generation <br/></p>

<ul>
<li> For each authenticated request, users need to generate a signature using their secret key. <br/></li>
<li>For GET requests: The data to be signed is the query string, which includes the timestamp and any other query parameters.<br/></li>
<li>For POST/PUT/DELETE requests: The data to be signed is the body of the request, which includes the timestamp, and any other
fields. <br/></li>
<li>The signature is generated by applying HMAC-SHA256 to the data (query string or body) using the user&#39;s secret key. <br/></li>
<li>The generated signature is sent in the request headers along with the API key. <br/></li>
</ul></li>
</ol>

<h2 id="get-request">getRequest Function</h2>

<p>The <code>getRequest</code> function sends a GET request to an API endpoint, handling both market and non-market endpoints differently. It adds a timestamp to the parameters for request uniqueness, generates a signature for authentication, and processes the response.</p>

<p>Sends a GET request to the specified endpoint with the given parameters:</p>

<ul>
<li>endpoint (string): The API endpoint to which the request is sent. <br/></li>
<li>params (Object, optional): Query parameters to include in the request. Defaults to an empty object.</li>
</ul>

<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="cm">/**
 * Sends a GET request to the specified endpoint with the given parameters.
 * 
 * @param {string} endpoint - The API endpoint to send the request to.
 * @param {Object} [params={}] - The query parameters to include in the request.
 * @returns {Promise&lt;Object&gt;} - The response data from the API.
 */</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">getRequest</span><span class="p">(</span><span class="nx">endpoint</span><span class="p">,</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{})</span> <span class="p">{</span>
    <span class="c1">// Add a timestamp to the parameters for request uniqueness</span>
    <span class="kd">const</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">().</span><span class="nx">toString</span><span class="p">();</span>
    <span class="nx">params</span><span class="p">.</span><span class="nx">timestamp</span> <span class="o">=</span> <span class="nx">timestamp</span><span class="p">;</span>

    <span class="c1">// Determine if the endpoint is a market endpoint</span>
    <span class="kd">const</span> <span class="nx">isMarketEndpoint</span> <span class="o">=</span> <span class="nx">endpoint</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="dl">"</span><span class="s2">/v1/market</span><span class="dl">"</span><span class="p">);</span>
    <span class="kd">let</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">""</span><span class="p">;</span>

    <span class="c1">// Construct the URL based on the endpoint type</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">isMarketEndpoint</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">publicBaseUrl</span><span class="p">}${</span><span class="nx">endpoint</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">baseUrl</span><span class="p">}${</span><span class="nx">endpoint</span><span class="p">}</span><span class="s2">?</span><span class="p">${</span><span class="k">new</span> <span class="nx">URLSearchParams</span><span class="p">(</span><span class="nx">params</span><span class="p">).</span><span class="nx">toString</span><span class="p">()}</span><span class="s2">`</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Generate a signature for the request</span>
    <span class="kd">const</span> <span class="nx">signature</span> <span class="o">=</span> <span class="nx">generateSignature</span><span class="p">(</span><span class="nx">params</span><span class="p">,</span> <span class="nx">apiSecret</span><span class="p">);</span>

    <span class="k">try</span> <span class="p">{</span>
        <span class="c1">// Send the GET request</span>
        <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">axios</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span>
            <span class="nx">url</span><span class="p">,</span>
            <span class="o">!</span><span class="nx">isMarketEndpoint</span> <span class="p">?</span> <span class="p">{</span>
                <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
                    <span class="dl">"</span><span class="s2">api-key</span><span class="dl">"</span><span class="p">:</span> <span class="nx">apiKey</span><span class="p">,</span>
                    <span class="dl">"</span><span class="s2">signature</span><span class="dl">"</span><span class="p">:</span> <span class="nx">signature</span><span class="p">,</span>
                <span class="p">},</span>
            <span class="p">}</span> <span class="p">:</span> <span class="p">{}</span>
        <span class="p">);</span>
        <span class="c1">// Log and return the response data</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Response:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Handle and log any errors that occur during the request</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span>
            <span class="dl">"</span><span class="s2">Error:</span><span class="dl">"</span><span class="p">,</span>
            <span class="nx">error</span><span class="p">.</span><span class="nx">response</span> <span class="p">?</span> <span class="nx">error</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span> <span class="p">:</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><h3 id='response'>Response</h3>
<p>Returns: A Promise that resolves to the response data from the API.</p>

<p>Error Handling: If an error occurs during the request, it logs the error message or response data to the console.</p>

<h2 id="post-request">postRequest Function</h2>

<p>The function sends POST requests to an API endpoint, handling both authenticated and public requests based on the endpoint URL.</p>

<ul>
<li>endpoint (string): The API endpoint to which the POST request is sent.</li>
<li>params (object): The parameters to be included in the POST request body. This is optional and defaults to an empty object.</li>
</ul>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="c1">// Generic POST request function</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">postRequest</span><span class="p">(</span><span class="nx">endpoint</span><span class="p">,</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{})</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">().</span><span class="nx">toString</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">isMarketEndpoint</span> <span class="o">=</span> <span class="nx">endpoint</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="dl">"</span><span class="s2">/v1/market</span><span class="dl">"</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">baseUrlToUse</span> <span class="o">=</span> <span class="nx">isMarketEndpoint</span> <span class="p">?</span> <span class="nx">publicBaseUrl</span> <span class="p">:</span> <span class="nx">baseUrl</span><span class="p">;</span>
  <span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">baseUrlToUse</span><span class="p">}${</span><span class="nx">endpoint</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isMarketEndpoint</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">params</span><span class="p">.</span><span class="nx">timestamp</span> <span class="o">=</span> <span class="nx">timestamp</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">const</span> <span class="nx">signature</span> <span class="o">=</span> <span class="nx">crypto</span>
    <span class="p">.</span><span class="nx">createHmac</span><span class="p">(</span><span class="dl">"</span><span class="s2">sha256</span><span class="dl">"</span><span class="p">,</span> <span class="nx">apiSecret</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">params</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">digest</span><span class="p">(</span><span class="dl">"</span><span class="s2">hex</span><span class="dl">"</span><span class="p">);</span>

  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">axios</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span>
      <span class="nx">url</span><span class="p">,</span>
      <span class="nx">params</span><span class="p">,</span>
      <span class="nx">isMarketEndpoint</span>
        <span class="p">?</span> <span class="p">{}</span>
        <span class="p">:</span> <span class="p">{</span>
            <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
              <span class="dl">"</span><span class="s2">api-key</span><span class="dl">"</span><span class="p">:</span> <span class="nx">apiKey</span><span class="p">,</span>
              <span class="na">signature</span><span class="p">:</span> <span class="nx">signature</span><span class="p">,</span>
            <span class="p">},</span>
          <span class="p">}</span>
    <span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Response:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span>
      <span class="dl">"</span><span class="s2">Error:</span><span class="dl">"</span><span class="p">,</span>
      <span class="nx">error</span><span class="p">.</span><span class="nx">response</span> <span class="p">?</span> <span class="nx">error</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span> <span class="p">:</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span>
    <span class="p">);</span>
    <span class="k">throw</span> <span class="nx">error</span><span class="p">;</span> <span class="c1">// Optional: re-throw the error if you want to handle it further up the call stack</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><h3 id='response-2'>Response</h3>
<p><code>console.log(&quot;Response:&quot;, response.data);</code> <br/>
Logs the response data to the console. <br/></p>

<p><code>return response.data;</code> <br/>
Returns the response data for further use.<br/></p>

<h2 id="put-request">putRequest Function</h2>

<p>This function, <code>putRequest</code>, is an asynchronous JavaScript function designed to send a signed <code>PUT</code> HTTP request to a specified API endpoint. Here&#39;s a breakdown of its components and behavior:</p>

<ul>
<li>endpoint: A string representing the API endpoint to which the request will be sent. It is appended to a base URL to form the complete request URL.</li>
<li>params: An optional object containing the parameters to be included in the request body. If no parameters are provided, an empty object is used by default.</li>
</ul>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">crypto</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">axios</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">axios</span><span class="dl">'</span><span class="p">);</span>

<span class="k">async</span> <span class="kd">function</span> <span class="nx">putRequest</span><span class="p">(</span><span class="nx">endpoint</span><span class="p">,</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{})</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">().</span><span class="nx">toString</span><span class="p">();</span>
  <span class="nx">params</span><span class="p">.</span><span class="nx">timestamp</span> <span class="o">=</span> <span class="nx">timestamp</span><span class="p">;</span>

  <span class="kd">const</span> <span class="nx">signature</span> <span class="o">=</span> <span class="nx">crypto</span>
    <span class="p">.</span><span class="nx">createHmac</span><span class="p">(</span><span class="dl">"</span><span class="s2">sha256</span><span class="dl">"</span><span class="p">,</span> <span class="nx">apiSecret</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">params</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">digest</span><span class="p">(</span><span class="dl">"</span><span class="s2">hex</span><span class="dl">"</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">baseUrl</span><span class="p">}${</span><span class="nx">endpoint</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>

  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">axios</span><span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">params</span><span class="p">,</span> <span class="p">{</span>
      <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
        <span class="dl">"</span><span class="s2">api-key</span><span class="dl">"</span><span class="p">:</span> <span class="nx">apiKey</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">signature</span><span class="dl">"</span><span class="p">:</span> <span class="nx">signature</span><span class="p">,</span>
      <span class="p">},</span>
    <span class="p">});</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Response:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>

  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span>
      <span class="dl">"</span><span class="s2">Error:</span><span class="dl">"</span><span class="p">,</span>
      <span class="nx">error</span><span class="p">.</span><span class="nx">response</span> <span class="p">?</span> <span class="nx">error</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span> <span class="p">:</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><h3 id='response-3'>Response</h3>
<p>If the request is successful, the response data is logged to the console and returned by the function.</p>

<h2 id="delete-request">deleteRequest Function</h2>

<p>This deleteRequest function is an asynchronous JavaScript function designed to send a signed DELETE HTTP request to a specified API endpoint. Below is a detailed explanation of its components and behavior:</p>

<ul>
<li>endpoint: A string representing the API endpoint to which the DELETE request will be sent. It is appended to a base URL to form the complete request URL.</li>
<li>params: An optional object containing the parameters to be included in the request. If no parameters are provided, an empty object is used by default.</li>
</ul>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">crypto</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">axios</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">axios</span><span class="dl">'</span><span class="p">);</span>

<span class="k">async</span> <span class="kd">function</span> <span class="nx">deleteRequest</span><span class="p">(</span><span class="nx">endpoint</span><span class="p">,</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{})</span> <span class="p">{</span>
  <span class="c1">// Generate a timestamp and add it to the params</span>
  <span class="kd">const</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">().</span><span class="nx">toString</span><span class="p">();</span>
  <span class="nx">params</span><span class="p">.</span><span class="nx">timestamp</span> <span class="o">=</span> <span class="nx">timestamp</span><span class="p">;</span>

  <span class="c1">// Create a cryptographic signature using HMAC with SHA-256</span>
  <span class="kd">const</span> <span class="nx">signature</span> <span class="o">=</span> <span class="nx">crypto</span>
    <span class="p">.</span><span class="nx">createHmac</span><span class="p">(</span><span class="dl">"</span><span class="s2">sha256</span><span class="dl">"</span><span class="p">,</span> <span class="nx">apiSecret</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">params</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">digest</span><span class="p">(</span><span class="dl">"</span><span class="s2">hex</span><span class="dl">"</span><span class="p">);</span>

  <span class="c1">// Construct the full request URL</span>
  <span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">baseUrl</span><span class="p">}${</span><span class="nx">endpoint</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>

  <span class="k">try</span> <span class="p">{</span>
    <span class="c1">// Send the DELETE request using axios</span>
    <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">axios</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="p">{</span>
      <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
        <span class="dl">"</span><span class="s2">api-key</span><span class="dl">"</span><span class="p">:</span> <span class="nx">apiKey</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">signature</span><span class="dl">"</span><span class="p">:</span> <span class="nx">signature</span><span class="p">,</span>
      <span class="p">},</span>
      <span class="na">data</span><span class="p">:</span> <span class="nx">params</span><span class="p">,</span>
    <span class="p">});</span>

    <span class="c1">// Log and return the response data if the request is successful</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Response:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>

  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Handle and log any errors that occur during the request</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span>
      <span class="dl">"</span><span class="s2">Error:</span><span class="dl">"</span><span class="p">,</span>
      <span class="nx">error</span><span class="p">.</span><span class="nx">response</span> <span class="p">?</span> <span class="nx">error</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span> <span class="p">:</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h1 id='rate-limits'>API Rate Limits</h1>

<p>Rate limits are mechanisms used to control the frequency of requests that can be made to an API. These rate limits are essential for maintaining optimal performance and avoiding server overloads, ensuring a smooth and reliable user experience across all API interactions.</p>

<p>Different endpoints may have varying rate limits depending on their purpose and the resources they consume.</p>

<table><thead>
<tr>
<th>Endpoint</th>
<th>Interval</th>
<th>Limit</th>
</tr>
</thead><tbody>
<tr>
<td>v1/order/place-order</td>
<td>1 second (1s)</td>
<td>20 requests</td>
</tr>
<tr>
<td>v1/order/delete-order</td>
<td>10 seconds (10s)</td>
<td>5 requests </td>
</tr>
<tr>
<td>All other endpoints</td>
<td>10 seconds (10s)</td>
<td>10 requests </td>
</tr>
</tbody></table>


<h1 id='orders'>Orders</h1>

<h2 id="place-order">Place an Order </h2>

<p><code>POST /v1/order/place-order</code></p>

<p>Place an order (either a market order or a limit order) on Pi42&#39;s trading platform.</p>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">placeOrder</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Market Order</span>
    <span class="kd">const</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">placeType</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POSITION</span><span class="dl">"</span><span class="p">,</span>       <span class="c1">// Indicates the type of order placement (e.g., POSITION or ORDER_FORM)</span>
        <span class="na">quantity</span><span class="p">:</span> <span class="mf">0.005</span><span class="p">,</span>             <span class="c1">// Quantity of the asset to be traded</span>
        <span class="na">side</span><span class="p">:</span> <span class="dl">"</span><span class="s2">SELL</span><span class="dl">"</span><span class="p">,</span>                <span class="c1">// Order side, either "BUY" or "SELL"</span>
        <span class="na">symbol</span><span class="p">:</span> <span class="dl">"</span><span class="s2">BTCUSDT</span><span class="dl">"</span><span class="p">,</span>           <span class="c1">// Trading pair, e.g., Bitcoin to USDT</span>
        <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">MARKET</span><span class="dl">"</span><span class="p">,</span>              <span class="c1">// Order type, either "MARKET" or "LIMIT"</span>
        <span class="na">reduceOnly</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>           <span class="c1">// Whether to reduce an existing position only</span>
        <span class="na">marginAsset</span><span class="p">:</span> <span class="dl">"</span><span class="s2">INR</span><span class="dl">"</span><span class="p">,</span>          <span class="c1">// The asset used as margin</span>
        <span class="na">deviceType</span><span class="p">:</span> <span class="dl">"</span><span class="s2">WEB</span><span class="dl">"</span><span class="p">,</span>           <span class="c1">// Indicates the device type (WEB, MOBILE, etc.)</span>
        <span class="na">userCategory</span><span class="p">:</span> <span class="dl">"</span><span class="s2">EXTERNAL</span><span class="dl">"</span><span class="p">,</span>    <span class="c1">// Category of the user (EXTERNAL, INTERNAL, etc.)</span>
    <span class="p">};</span>

    <span class="c1">// Limit order: Uncomment and use this block if placing a limit order instead of a market order</span>
    <span class="c1">// const params = {</span>
    <span class="c1">//     placeType: "ORDER_FORM",</span>
    <span class="c1">//     quantity: 0.003,</span>
    <span class="c1">//     reduceOnly: false,</span>
    <span class="c1">//     side: "BUY",</span>
    <span class="c1">//     symbol: "BTCUSDT",</span>
    <span class="c1">//     type: "LIMIT",</span>
    <span class="c1">//     price: 48000,               // Price at which the limit order should be executed</span>
    <span class="c1">//     positionSide: "BOTH",</span>
    <span class="c1">//     timeInForce: "GTC",        // Good-Til-Canceled, other options could be IOC (Immediate-Or-Cancel), etc.</span>
    <span class="c1">//     isolated: true,</span>
    <span class="c1">//     newOrderRespType: "ACK",</span>
    <span class="c1">//     positionId: "string",</span>
    <span class="c1">//     stopPrice: 0,              // Stop price for a stop order (not needed for a regular limit order)</span>
    <span class="c1">//     refId: "dsfssa",           // Reference ID for tracking purposes</span>
    <span class="c1">//     marginAsset: "INR",</span>
    <span class="c1">// };</span>

    <span class="kd">const</span> <span class="nx">endpoint</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">/v1/order/place-order</span><span class="dl">"</span><span class="p">;</span>  <span class="c1">// API endpoint to place the order</span>

    <span class="c1">// Call the postRequest function to send the POST request with the order parameters</span>
    <span class="k">return</span> <span class="k">await</span> <span class="nx">postRequest</span><span class="p">(</span><span class="nx">endpoint</span><span class="p">,</span> <span class="nx">params</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="k">def</span> <span class="nf">place_order</span><span class="p">():</span>
    <span class="c1"># Generate the current timestamp in milliseconds
</span>    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>

    <span class="c1"># Define the order parameters
</span>    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'timestamp'</span><span class="p">:</span> <span class="n">timestamp</span><span class="p">,</span>        <span class="c1"># Current timestamp in milliseconds
</span>        <span class="s">'placeType'</span><span class="p">:</span> <span class="s">'ORDER_FORM'</span><span class="p">,</span>     <span class="c1"># Type of order placement, e.g., 'ORDER_FORM'
</span>        <span class="s">'quantity'</span><span class="p">:</span> <span class="mf">0.002</span><span class="p">,</span>             <span class="c1"># Quantity of the asset to trade
</span>        <span class="s">'side'</span><span class="p">:</span> <span class="s">'BUY'</span><span class="p">,</span>                 <span class="c1"># Order side, either 'BUY' or 'SELL'
</span>        <span class="s">'symbol'</span><span class="p">:</span> <span class="s">'BTCUSDT'</span><span class="p">,</span>           <span class="c1"># Trading pair, e.g., Bitcoin to USDT
</span>        <span class="s">'type'</span><span class="p">:</span> <span class="s">'MARKET'</span><span class="p">,</span>              <span class="c1"># Order type, either 'MARKET' or 'LIMIT'
</span>        <span class="s">'reduceOnly'</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>           <span class="c1"># Whether to reduce an existing position only
</span>        <span class="s">'marginAsset'</span><span class="p">:</span> <span class="s">'INR'</span><span class="p">,</span>          <span class="c1"># The asset used as margin (INR in this case)
</span>        <span class="s">'deviceType'</span><span class="p">:</span> <span class="s">'WEB'</span><span class="p">,</span>           <span class="c1"># Device type (e.g., WEB, MOBILE)
</span>        <span class="s">'userCategory'</span><span class="p">:</span> <span class="s">'EXTERNAL'</span><span class="p">,</span>    <span class="c1"># User category (e.g., EXTERNAL, INTERNAL)
</span>        <span class="s">'price'</span><span class="p">:</span> <span class="mi">50000</span><span class="p">,</span>                <span class="c1"># Price for the limit order (included here but irrelevant for market orders)
</span>    <span class="p">}</span>

    <span class="c1"># Convert the parameters to a JSON string to sign
</span>    <span class="n">data_to_sign</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">separators</span><span class="o">=</span><span class="p">(</span><span class="s">','</span><span class="p">,</span> <span class="s">':'</span><span class="p">))</span>

    <span class="c1"># Generate the signature for authentication
</span>    <span class="n">signature</span> <span class="o">=</span> <span class="n">generate_signature</span><span class="p">(</span><span class="n">api_secret</span><span class="p">,</span> <span class="n">data_to_sign</span><span class="p">)</span>

    <span class="c1"># Define the headers including the API key and the signature
</span>    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">api_key</span><span class="p">,</span>
        <span class="s">'signature'</span><span class="p">:</span> <span class="n">signature</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Send the POST request to place the order
</span>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s">/v1/order/place-order'</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

        <span class="c1"># Raise an HTTPError if the response status is 4xx or 5xx
</span>        <span class="n">response</span><span class="p">.</span><span class="n">raise_for_status</span><span class="p">()</span>

        <span class="c1"># Parse the JSON response data
</span>        <span class="n">response_data</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()</span>

        <span class="c1"># Print the success message with the order details
</span>        <span class="k">print</span><span class="p">(</span><span class="s">'Order placed successfully:'</span><span class="p">,</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">response_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>

    <span class="k">except</span> <span class="n">requests</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="c1"># Handle HTTP errors specifically
</span>        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Error: </span><span class="si">{</span><span class="n">err</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">text</span> <span class="k">if</span> <span class="n">err</span><span class="p">.</span><span class="n">response</span> <span class="k">else</span> <span class="n">err</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># Handle any other unexpected errors
</span>        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"An unexpected error occurred: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div>
<h2 id="add-margin"> Add Margin </h2>

<p><code>POST /v1/order/add-margin</code></p>

<p>Add margin to an existing trading position.</p>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">addMargin</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Define the API endpoint for adding margin</span>
    <span class="kd">const</span> <span class="nx">endpoint</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">/v1/order/add-margin</span><span class="dl">"</span><span class="p">;</span>

    <span class="c1">// Define the fixed values for positionId and amount</span>
    <span class="kd">const</span> <span class="nx">positionId</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">18c6c979-b089-4e67-b627-4c2072d0d5cb</span><span class="dl">"</span><span class="p">;</span>  <span class="c1">// Unique identifier for the position</span>
    <span class="kd">const</span> <span class="nx">amount</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>  <span class="c1">// The amount of margin to be added</span>

    <span class="c1">// Prepare request payload</span>
    <span class="kd">const</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">positionId</span><span class="p">:</span> <span class="nx">positionId</span><span class="p">,</span>  <span class="c1">// ID of the position to which margin is being added</span>
        <span class="na">amount</span><span class="p">:</span> <span class="nx">amount</span><span class="p">,</span>          <span class="c1">// Amount of margin to add</span>
    <span class="p">};</span>

    <span class="c1">// Call the postRequest function to send the POST request to the API</span>
    <span class="k">return</span> <span class="k">await</span> <span class="nx">postRequest</span><span class="p">(</span><span class="nx">endpoint</span><span class="p">,</span> <span class="nx">params</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="k">def</span> <span class="nf">add_margin</span><span class="p">():</span>
    <span class="n">position_id</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Enter the positionId: "</span><span class="p">)</span>
    <span class="n">amount_input</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Enter the amount: "</span><span class="p">)</span>

    <span class="n">add_margin_url</span> <span class="o">=</span> <span class="s">"https://fapi.pi42.com/v1/order/add-margin"</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">amount</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">amount_input</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">ValueError</span><span class="p">:</span>
        <span class="n">amount</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">amount_input</span><span class="p">)</span>

    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>

    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'positionId'</span><span class="p">:</span> <span class="n">position_id</span><span class="p">,</span>
        <span class="s">'amount'</span><span class="p">:</span> <span class="n">amount</span><span class="p">,</span>
        <span class="s">'timestamp'</span><span class="p">:</span> <span class="n">timestamp</span>
    <span class="p">}</span>

    <span class="n">data_to_sign</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">separators</span><span class="o">=</span><span class="p">(</span><span class="s">','</span><span class="p">,</span> <span class="s">':'</span><span class="p">))</span>
    <span class="n">signature</span> <span class="o">=</span> <span class="n">generate_signature</span><span class="p">(</span><span class="n">api_secret</span><span class="p">,</span> <span class="n">data_to_sign</span><span class="p">)</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">api_key</span><span class="p">,</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'signature'</span><span class="p">:</span> <span class="n">signature</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">add_margin_url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
        <span class="n">response</span><span class="p">.</span><span class="n">raise_for_status</span><span class="p">()</span>
        <span class="n">response_data</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'Margin added successfully:'</span><span class="p">,</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">response_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>

    <span class="k">except</span> <span class="n">requests</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Failed </span><span class="si">{</span><span class="n">response</span><span class="p">.</span><span class="n">status_code</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"An unexpected error occurred: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

</code></pre></div>
<h2 id="reduce-margin">Reduce Margin</h2>

<p><code>POST /v1/order/reduce-margin</code></p>

<p>Reduce the margin on an existing trading position.</p>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">reduceMargin</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Define the API endpoint for reducing margin</span>
    <span class="kd">const</span> <span class="nx">endpoint</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">/v1/order/reduce-margin</span><span class="dl">"</span><span class="p">;</span>

    <span class="c1">// Define the fixed values for positionId and amount</span>
    <span class="kd">const</span> <span class="nx">positionId</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">18c6c979-b089-4e67-b627-4c2072d0d5cb</span><span class="dl">"</span><span class="p">;</span>  <span class="c1">// Unique identifier for the position</span>
    <span class="kd">const</span> <span class="nx">amount</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>  <span class="c1">// The amount of margin to be reduced</span>

    <span class="c1">// Prepare request payload</span>
    <span class="kd">const</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">positionId</span><span class="p">:</span> <span class="nx">positionId</span><span class="p">,</span>  <span class="c1">// ID of the position from which margin is being reduced</span>
        <span class="na">amount</span><span class="p">:</span> <span class="nx">amount</span><span class="p">,</span>          <span class="c1">// Amount of margin to reduce</span>
    <span class="p">};</span>

    <span class="c1">// Call the postRequest function to send the POST request to the API</span>
    <span class="k">return</span> <span class="k">await</span> <span class="nx">postRequest</span><span class="p">(</span><span class="nx">endpoint</span><span class="p">,</span> <span class="nx">params</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="k">def</span> <span class="nf">reduce_margin</span><span class="p">():</span>
    <span class="c1"># Collect position ID and amount to reduce from user input
</span>    <span class="n">position_id</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Enter the positionId: "</span><span class="p">)</span>
    <span class="n">amountInput</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Enter the amount to reduce: "</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Convert input to integer or float as necessary
</span>        <span class="n">amount</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">amountInput</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">ValueError</span><span class="p">:</span>
        <span class="n">amount</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">amountInput</span><span class="p">)</span>

    <span class="c1"># Generate current timestamp in milliseconds
</span>    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>

    <span class="c1"># Prepare the request payload (JSON)
</span>    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'positionId'</span><span class="p">:</span> <span class="n">position_id</span><span class="p">,</span>
        <span class="s">'amount'</span><span class="p">:</span> <span class="n">amount</span><span class="p">,</span>
        <span class="s">'timestamp'</span><span class="p">:</span> <span class="n">timestamp</span>
    <span class="p">}</span>

    <span class="c1"># Convert the payload to a JSON string for signature
</span>    <span class="n">data_to_sign</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">separators</span><span class="o">=</span><span class="p">(</span><span class="s">','</span><span class="p">,</span> <span class="s">':'</span><span class="p">))</span>

    <span class="c1"># Generate the signature using a helper function
</span>    <span class="n">signature</span> <span class="o">=</span> <span class="n">generate_signature</span><span class="p">(</span><span class="n">api_secret</span><span class="p">,</span> <span class="n">data_to_sign</span><span class="p">)</span>

    <span class="c1"># Set the headers for the POST request
</span>    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">api_key</span><span class="p">,</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'signature'</span><span class="p">:</span> <span class="n">signature</span>
    <span class="p">}</span>

    <span class="c1"># Construct the full API endpoint URL
</span>    <span class="n">reduce_margin_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s">/v1/order/reduce-margin"</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Send the POST request to reduce margin
</span>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">reduce_margin_url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
        <span class="n">response</span><span class="p">.</span><span class="n">raise_for_status</span><span class="p">()</span>  <span class="c1"># Raises an error for HTTP responses with 4xx/5xx status codes
</span>        <span class="n">response_data</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'Margin reduced successfully:'</span><span class="p">,</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">response_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
    <span class="k">except</span> <span class="n">requests</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Error: </span><span class="si">{</span><span class="n">err</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">text</span> <span class="k">if</span> <span class="n">err</span><span class="p">.</span><span class="n">response</span> <span class="k">else</span> <span class="n">err</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"An unexpected error occurred: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div>
<h2 id="get-open-orders">Get Open Orders</h2>

<p><code>GET /v1/order/open-orders</code></p>

<p>The sample codes in different languages are provided below:</p>
<div class="highlight"><pre class="highlight python tab-python"><code><span class="k">def</span> <span class="nf">get_open_orders</span><span class="p">():</span>
<span class="c1"># Generate the current timestamp
</span>    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>

<span class="c1"># Prepare parameters with the current timestamp
</span>    <span class="n">params</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"timestamp=</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s">"</span>

<span class="c1"># Generate the signature using the current timestamp
</span>    <span class="n">signature</span> <span class="o">=</span> <span class="n">generate_signature</span><span class="p">(</span><span class="n">api_secret</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

<span class="c1"># Prepare headers
</span>    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'api-key'</span><span class="p">:</span> <span class="n">api_key</span><span class="p">,</span>
    <span class="s">'signature'</span><span class="p">:</span> <span class="n">signature</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">open_orders_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s">/v1/order/open-orders"</span>
    <span class="k">try</span><span class="p">:</span>

<span class="c1"># Send GET request to fetch open orders with the timestamp parameter
</span>    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">open_orders_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s">'timestamp'</span><span class="p">:</span> <span class="n">timestamp</span><span class="p">})</span>
    <span class="n">response</span><span class="p">.</span><span class="n">raise_for_status</span><span class="p">()</span> <span class="c1"># Raises an error for bad HTTP responses
</span>    <span class="n">response_data</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Open orders fetched successfully:'</span><span class="p">,</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">response_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
    <span class="k">except</span> <span class="n">requests</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Failed </span><span class="si">{</span><span class="n">response</span><span class="p">.</span><span class="n">status_code</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"An unexpected error occurred: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">getOpenOrders</span><span class="p">()</span> <span class="p">{</span>
<span class="kd">const</span> <span class="nx">pageSize</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">sortOrder</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">desc</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">startTimestamp</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">1696425435000</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">endTimestamp</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">1725451568979</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">symbol</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">BTCUSDT</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{</span>
 <span class="c1">// Optional Params</span>
    <span class="na">pageSize</span><span class="p">:</span> <span class="nx">pageSize</span><span class="p">.</span><span class="nx">toString</span><span class="p">(),</span>
    <span class="na">sortOrder</span><span class="p">:</span> <span class="nx">sortOrder</span><span class="p">,</span>
    <span class="na">startTimestamp</span><span class="p">:</span> <span class="nx">startTimestamp</span><span class="p">,</span>
    <span class="na">endTimestamp</span><span class="p">:</span> <span class="nx">endTimestamp</span><span class="p">,</span>
    <span class="na">symbol</span><span class="p">:</span> <span class="nx">symbol</span><span class="p">,</span>
    <span class="p">};</span>

<span class="kd">const</span> <span class="nx">endpoint</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">/v1/order/open-orders</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// Your endpoint for fetching open orders</span>

<span class="c1">// Call the postRequest function</span>
<span class="k">return</span> <span class="k">await</span> <span class="nx">getRequest</span><span class="p">(</span><span class="nx">endpoint</span><span class="p">,</span> <span class="nx">params</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="get-order-history">Get Order History</h2>

<p><code>GET /v1/order/order-history</code></p>
<div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># Function to fetch and display order history
</span><span class="k">def</span> <span class="nf">order_history</span><span class="p">():</span>
<span class="n">timestamp</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>
<span class="n">order_history_url</span> <span class="o">=</span> <span class="s">"https://fapi.pi42.com/v1/order/order-history"</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
<span class="s">'sortOrder'</span><span class="p">:</span> <span class="s">'desc'</span><span class="p">,</span>
<span class="s">'pageSize'</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
<span class="s">'timestamp'</span><span class="p">:</span> <span class="n">timestamp</span>
 <span class="p">}</span>

<span class="n">query_string</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"sortOrder=</span><span class="si">{</span><span class="n">params</span><span class="p">[</span><span class="s">'sortOrder'</span><span class="p">]</span><span class="si">}</span><span class="s">&amp;pageSize=</span><span class="si">{</span><span class="n">params</span><span class="p">[</span><span class="s">'pageSize'</span><span class="p">]</span><span class="si">}</span><span class="s">&amp;timestamp=
</span><span class="si">{</span><span class="n">params</span><span class="p">[</span><span class="s">'timestamp'</span><span class="p">]</span><span class="si">}</span><span class="s">"</span>

<span class="n">signature</span> <span class="o">=</span> <span class="n">generate_signature</span><span class="p">(</span><span class="n">api_secret</span><span class="p">,</span> <span class="n">query_string</span><span class="p">)</span>

<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
<span class="s">'api-key'</span><span class="p">:</span> <span class="n">api_key</span><span class="p">,</span>
<span class="s">'signature'</span><span class="p">:</span> <span class="n">signature</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">try</span><span class="p">:</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">order_history_url</span><span class="si">}</span><span class="s">?</span><span class="si">{</span><span class="n">query_string</span><span class="si">}</span><span class="s">"</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="n">response</span><span class="p">.</span><span class="n">raise_for_status</span><span class="p">()</span>
<span class="n">response_data</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Order history fetched successfully:'</span><span class="p">,</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">response_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
<span class="k">except</span> <span class="n">requests</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Failed </span><span class="si">{</span><span class="n">response</span><span class="p">.</span><span class="n">status_code</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="c1">//Get Order History</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">getOrderHistory</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">pageSize</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
  <span class="kd">const</span> <span class="nx">sortOrder</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">desc</span><span class="dl">"</span><span class="p">;</span>
  <span class="kd">const</span> <span class="nx">startTimestamp</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">1696425435000</span><span class="dl">"</span><span class="p">;</span>
  <span class="kd">const</span> <span class="nx">endTimestamp</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">1725451568979</span><span class="dl">"</span><span class="p">;</span>
  <span class="kd">const</span> <span class="nx">symbol</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">BTCUSDT</span><span class="dl">"</span><span class="p">;</span>
  <span class="kd">const</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1">// Optional Params</span>
    <span class="na">pageSize</span><span class="p">:</span> <span class="nx">pageSize</span><span class="p">.</span><span class="nx">toString</span><span class="p">(),</span>
    <span class="na">sortOrder</span><span class="p">:</span> <span class="nx">sortOrder</span><span class="p">,</span>
    <span class="na">startTimestamp</span><span class="p">:</span> <span class="nx">startTimestamp</span><span class="p">,</span>
    <span class="na">endTimestamp</span><span class="p">:</span> <span class="nx">endTimestamp</span><span class="p">,</span>
    <span class="na">symbol</span><span class="p">:</span> <span class="nx">symbol</span><span class="p">,</span>
  <span class="p">};</span>
  <span class="kd">const</span> <span class="nx">endpoint</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">/v1/order/order-history</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// Your endpoint for fetching order history</span>
  <span class="c1">// Call the postRequest function</span>
  <span class="k">return</span> <span class="k">await</span> <span class="nx">getRequest</span><span class="p">(</span><span class="nx">endpoint</span><span class="p">,</span> <span class="nx">params</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="get-linked-orders">Get Linked Orders</h2>

<p><code>GET /v1/order/linked-orders</code> </p>
<div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># Function to fetch linked orders based on linkId
</span><span class="k">def</span> <span class="nf">linked_orders</span><span class="p">():</span>
<span class="n">link_id</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Enter the Link Id: "</span><span class="p">)</span>
<span class="n">timestamp</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>
<span class="n">linked_orders_url</span> <span class="o">=</span> <span class="s">"https://fapi.pi42.com/v1/order/linked-orders"</span>

<span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">linked_orders_url</span><span class="si">}</span><span class="s">/</span><span class="si">{</span><span class="n">link_id</span><span class="si">}</span><span class="s">"</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
<span class="s">'timestamp'</span><span class="p">:</span> <span class="n">timestamp</span>
<span class="p">}</span>
<span class="n">query_string</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"timestamp=</span><span class="si">{</span><span class="n">params</span><span class="p">[</span><span class="s">'timestamp'</span><span class="p">]</span><span class="si">}</span><span class="s">"</span>

<span class="n">signature</span> <span class="o">=</span> <span class="n">generate_signature</span><span class="p">(</span><span class="n">api_secret</span><span class="p">,</span> <span class="n">query_string</span><span class="p">)</span>

<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
<span class="s">'api-key'</span><span class="p">:</span> <span class="n">api_key</span><span class="p">,</span>
<span class="s">'signature'</span><span class="p">:</span> <span class="n">signature</span><span class="p">,</span>
<span class="s">'accept'</span><span class="p">:</span> <span class="s">'*/*'</span>
 <span class="p">}</span>
<span class="k">try</span><span class="p">:</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s">?</span><span class="si">{</span><span class="n">query_string</span><span class="si">}</span><span class="s">"</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="n">response</span><span class="p">.</span><span class="n">raise_for_status</span><span class="p">()</span>
<span class="n">response_data</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Linked orders fetched successfully:'</span><span class="p">,</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">response_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
<span class="k">except</span> <span class="n">requests</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Failed </span><span class="si">{</span><span class="n">response</span><span class="p">.</span><span class="n">status_code</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code>
<span class="c1">// Get Linked Orders</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">linkedOrders</span><span class="p">(</span><span class="nx">linkId</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">linkId</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">6acd808ba5957340b009-6238-ext</span><span class="dl">"</span>
  <span class="kd">const</span> <span class="nx">endpoint</span> <span class="o">=</span> <span class="s2">`/v1/order/linked-orders/</span><span class="p">${</span><span class="nx">linkId</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span> <span class="c1">// Endpoint for fetching linked orders</span>

<span class="c1">// Call the getRequest function (similar to postRequest)</span>
  <span class="k">return</span> <span class="k">await</span> <span class="nx">getRequest</span><span class="p">(</span><span class="nx">endpoint</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Fetch Margin History</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">fetchMarginHistory</span><span class="p">()</span> <span class="p">{</span>
 <span class="kd">const</span> <span class="nx">endpoint</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">/v1/order/fetch-margin-history</span><span class="dl">"</span><span class="p">;</span>
 <span class="kd">const</span> <span class="nx">pageSize</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
 <span class="kd">const</span> <span class="nx">sortOrder</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">desc</span><span class="dl">"</span><span class="p">;</span>
 <span class="kd">const</span> <span class="nx">startTimestamp</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">1696425435000</span><span class="dl">"</span><span class="p">;</span>
 <span class="kd">const</span> <span class="nx">endTimestamp</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">1725451568979</span><span class="dl">"</span><span class="p">;</span>
 <span class="kd">const</span> <span class="nx">symbol</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">BTCUSDT</span><span class="dl">"</span><span class="p">;</span>

<span class="c1">// Prepare query parameters</span>
 <span class="kd">const</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{</span>

<span class="c1">// Optional Params</span>
 <span class="na">pageSize</span><span class="p">:</span> <span class="nx">pageSize</span><span class="p">.</span><span class="nx">toString</span><span class="p">(),</span>
 <span class="na">sortOrder</span><span class="p">:</span> <span class="nx">sortOrder</span><span class="p">,</span>
 <span class="na">startTimestamp</span><span class="p">:</span> <span class="nx">startTimestamp</span><span class="p">,</span>
 <span class="na">endTimestamp</span><span class="p">:</span> <span class="nx">endTimestamp</span><span class="p">,</span>
 <span class="na">symbol</span><span class="p">:</span> <span class="nx">symbol</span><span class="p">,</span>
 <span class="p">};</span>
</code></pre></div>
<h2 id="get-margin-history">Fetch Margin History</h2>

<p><code>GET /v1/order/fetch-margin-history</code></p>
<div class="highlight"><pre class="highlight python tab-python"><code><span class="k">def</span> <span class="nf">fetch_margin_history</span><span class="p">():</span>
    <span class="n">endpoint</span> <span class="o">=</span> <span class="s">"/v1/order/fetch-margin-history"</span>
    <span class="n">symbol</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Enter the symbol (e.g., BTCUSDT): "</span><span class="p">).</span><span class="n">upper</span><span class="p">()</span>

    <span class="n">pageSize</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="n">sortOrder</span> <span class="o">=</span> <span class="s">"desc"</span>

<span class="c1"># Generate current timestamp for signing
</span> <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>

<span class="c1"># Prepare query parameters
</span>    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'pageSize'</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">pageSize</span><span class="p">),</span>
    <span class="s">'sortOrder'</span><span class="p">:</span> <span class="n">sortOrder</span><span class="p">,</span>
    <span class="s">'symbol'</span><span class="p">:</span> <span class="n">symbol</span><span class="p">,</span>
    <span class="s">'timestamp'</span><span class="p">:</span> <span class="n">timestamp</span>
    <span class="p">}</span>

<span class="c1"># Convert params to query string
</span>    <span class="n">query_string</span> <span class="o">=</span> <span class="s">'&amp;'</span><span class="p">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s">=</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s">"</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">params</span><span class="p">.</span><span class="n">items</span><span class="p">()])</span>

<span class="c1"># Generate signature
</span>    <span class="n">signature</span> <span class="o">=</span> <span class="n">generate_signature</span><span class="p">(</span><span class="n">api_secret</span><span class="p">,</span> <span class="n">query_string</span><span class="p">)</span>

<span class="c1"># Headers for the request
</span>    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'api-key'</span><span class="p">:</span> <span class="n">api_key</span><span class="p">,</span>
     <span class="s">'signature'</span><span class="p">:</span> <span class="n">signature</span><span class="p">,</span>
    <span class="s">'accept'</span><span class="p">:</span> <span class="s">'*/*'</span>
    <span class="p">}</span>
<span class="n">full_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">base_url</span><span class="si">}{</span><span class="n">endpoint</span><span class="si">}</span><span class="s">?</span><span class="si">{</span><span class="n">query_string</span><span class="si">}</span><span class="s">"</span>

<span class="k">try</span><span class="p">:</span>
<span class="c1"># Send the GET request to fetch margin history
</span><span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">full_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="n">response</span><span class="p">.</span><span class="n">raise_for_status</span><span class="p">()</span> <span class="c1"># Raises an error for 4xx/5xx responses
</span><span class="n">response_data</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Margin history fetched successfully:'</span><span class="p">,</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">response_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
<span class="k">except</span> <span class="n">requests</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Error: </span><span class="si">{</span><span class="n">err</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">text</span> <span class="k">if</span> <span class="n">err</span><span class="p">.</span><span class="n">response</span> <span class="k">else</span> <span class="n">err</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"An unexpected error occurred: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="c1">// Fetch Margin History</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">fetchMarginHistory</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">endpoint</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">/v1/order/fetch-margin-history</span><span class="dl">"</span><span class="p">;</span>

  <span class="kd">const</span> <span class="nx">pageSize</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
  <span class="kd">const</span> <span class="nx">sortOrder</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">desc</span><span class="dl">"</span><span class="p">;</span>
  <span class="kd">const</span> <span class="nx">startTimestamp</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">1696425435000</span><span class="dl">"</span><span class="p">;</span>
  <span class="kd">const</span> <span class="nx">endTimestamp</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">1725451568979</span><span class="dl">"</span><span class="p">;</span>
  <span class="kd">const</span> <span class="nx">symbol</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">BTCUSDT</span><span class="dl">"</span><span class="p">;</span>

<span class="c1">// Prepare query parameters</span>
  <span class="kd">const</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{</span>

<span class="c1">// Optional Params</span>
    <span class="na">pageSize</span><span class="p">:</span> <span class="nx">pageSize</span><span class="p">.</span><span class="nx">toString</span><span class="p">(),</span>
    <span class="na">sortOrder</span><span class="p">:</span> <span class="nx">sortOrder</span><span class="p">,</span>
    <span class="na">startTimestamp</span><span class="p">:</span> <span class="nx">startTimestamp</span><span class="p">,</span>
    <span class="na">endTimestamp</span><span class="p">:</span> <span class="nx">endTimestamp</span><span class="p">,</span>
    <span class="na">symbol</span><span class="p">:</span> <span class="nx">symbol</span><span class="p">,</span>
  <span class="p">};</span>

<span class="c1">// Call the getRequest function</span>
  <span class="k">return</span> <span class="k">await</span> <span class="nx">getRequest</span><span class="p">(</span><span class="nx">endpoint</span><span class="p">,</span> <span class="nx">params</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="get-postions">Get Positions</h2>

<p><code>GET /v1/positions</code></p>
<div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># Function to fetch positions
</span><span class="k">def</span> <span class="nf">fetch_positions</span><span class="p">():</span>
<span class="n">position_status</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Enter position status (open, closed, liquidated): "</span><span class="p">).</span><span class="n">upper</span><span class="p">()</span>
<span class="n">symbol</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Enter the trading pair (e.g., BTCINR): "</span><span class="p">).</span><span class="n">upper</span><span class="p">()</span>

<span class="k">if</span> <span class="n">position_status</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s">"OPEN"</span><span class="p">,</span> <span class="s">"CLOSED"</span><span class="p">,</span> <span class="s">"LIQUIDATED"</span><span class="p">]:</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Invalid position status. Please enter 'open', 'closed', or 'liquidated'."</span><span class="p">)</span>
<span class="k">return</span>

<span class="c1"># Optional parameters
</span><span class="n">sort_order</span> <span class="o">=</span> <span class="s">"desc"</span> <span class="c1"># Default sort order
</span><span class="n">page_size</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># Default page size
</span>
<span class="c1"># Prepare the query parameters
</span><span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
<span class="s">'sortOrder'</span><span class="p">:</span> <span class="n">sort_order</span><span class="p">,</span>
<span class="s">'pageSize'</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">page_size</span><span class="p">),</span>
<span class="s">'symbol'</span><span class="p">:</span> <span class="n">symbol</span><span class="p">,</span>
  <span class="p">}</span>

<span class="c1"># Generate current timestamp
</span><span class="n">timestamp</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>
<span class="n">params</span><span class="p">[</span><span class="s">'timestamp'</span><span class="p">]</span> <span class="o">=</span> <span class="n">timestamp</span>

<span class="c1"># Generate signature based on the parameters
</span><span class="n">query_string</span> <span class="o">=</span> <span class="s">'&amp;'</span><span class="p">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s">=</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s">"</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">params</span><span class="p">.</span><span class="n">items</span><span class="p">()])</span>
<span class="n">signature</span> <span class="o">=</span> <span class="n">generate_signature</span><span class="p">(</span><span class="n">api_secret</span><span class="p">,</span> <span class="n">query_string</span><span class="p">)</span>

<span class="c1"># Headers for the GET request
</span><span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
<span class="s">'api-key'</span><span class="p">:</span> <span class="n">api_key</span><span class="p">,</span>
<span class="s">'signature'</span><span class="p">:</span> <span class="n">signature</span><span class="p">,</span>
<span class="s">'accept'</span><span class="p">:</span> <span class="s">'*/*'</span>
 <span class="p">}</span>

<span class="c1"># Construct the full URL including the path parameter for position status
</span><span class="n">full_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s">/v1/positions/</span><span class="si">{</span><span class="n">position_status</span><span class="si">}</span><span class="s">?</span><span class="si">{</span><span class="n">query_string</span><span class="si">}</span><span class="s">"</span>

<span class="k">try</span><span class="p">:</span>
<span class="c1"># Send the GET request to fetch positions
</span><span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">full_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="n">response</span><span class="p">.</span><span class="n">raise_for_status</span><span class="p">()</span> <span class="c1"># Raises an error for 4xx/5xx responses
</span><span class="n">response_data</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Positions fetched successfully:'</span><span class="p">,</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">response_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
<span class="k">except</span> <span class="n">requests</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Error: </span><span class="si">{</span><span class="n">err</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">text</span> <span class="k">if</span> <span class="n">err</span><span class="p">.</span><span class="n">response</span> <span class="k">else</span> <span class="n">err</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"An unexpected error occurred: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">fetchPositions</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">endpoint</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">/v1/positions/</span><span class="dl">"</span><span class="p">;</span>

  <span class="kd">const</span> <span class="nx">positionStatus</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">OPEN</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// Required parameter</span>
  <span class="kd">const</span> <span class="nx">startTimestamp</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">1696425435000</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// Optional</span>
  <span class="kd">const</span> <span class="nx">endTimestamp</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">1725451568979</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// Optional</span>
  <span class="kd">const</span> <span class="nx">sortOrder</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">desc</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// Optional</span>
  <span class="kd">const</span> <span class="nx">pageSize</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span> <span class="c1">// Optional</span>
  <span class="kd">const</span> <span class="nx">symbol</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">BTCINR</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// Optional</span>

  <span class="kd">const</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1">// Optional Params</span>
    <span class="c1">// pageSize: pageSize.toString(),</span>
    <span class="c1">// sortOrder: sortOrder,</span>
    <span class="c1">// startTimestamp: startTimestamp,</span>
    <span class="c1">// endTimestamp: endTimestamp,</span>
    <span class="c1">// symbol: symbol,</span>
  <span class="p">};</span>
  <span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoint</span><span class="p">}${</span><span class="nx">positionStatus</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>

<span class="c1">// Call the getRequest function</span>
  <span class="k">return</span> <span class="k">await</span> <span class="nx">getRequest</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">params</span><span class="p">);</span>
<span class="p">}</span>

</code></pre></div>
<h2 id="get-position-status">Get Position Status</h2>

<p><code>GET /v1/positions/{positionStatus}</code></p>
<div class="highlight"><pre class="highlight python tab-python"><code><span class="k">def</span> <span class="nf">get_positions</span><span class="p">():</span>
 <span class="n">position_status</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Enter position status (open, closed, liquidated): "</span><span class="p">).</span><span class="n">upper</span><span class="p">()</span>

  <span class="k">if</span> <span class="n">position_status</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s">"OPEN"</span><span class="p">,</span> <span class="s">"CLOSED"</span><span class="p">,</span> <span class="s">"LIQUIDATED"</span><span class="p">]:</span>
  <span class="k">print</span><span class="p">(</span><span class="s">"Invalid position status. Please enter 'open', 'closed', or 'liquidated'."</span><span class="p">)</span>
  <span class="k">return</span>

<span class="c1"># Generate the current timestamp
</span>    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>

<span class="c1"># Prepare the query parameters
</span>    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'sortOrder'</span><span class="p">:</span> <span class="s">'desc'</span><span class="p">,</span>
    <span class="s">'pageSize'</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="s">'timestamp'</span><span class="p">:</span> <span class="n">timestamp</span>
    <span class="p">}</span>

<span class="c1"># Convert the params into a query string to sign
</span>    <span class="n">query_string</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"sortOrder=</span><span class="si">{</span><span class="n">params</span><span class="p">[</span><span class="s">'sortOrder'</span><span class="p">]</span><span class="si">}</span><span class="s">&amp;pageSize=</span><span class="si">{</span><span class="n">params</span><span class="p">[</span><span class="s">'pageSize'</span><span class="p">]</span><span class="si">}</span><span class="s">&amp;timestamp=
    </span><span class="si">{</span><span class="n">params</span><span class="p">[</span><span class="s">'timestamp'</span><span class="p">]</span><span class="si">}</span><span class="s">"</span>

<span class="c1"># Generate the signature
</span> <span class="n">signature</span> <span class="o">=</span> <span class="n">generate_signature</span><span class="p">(</span><span class="n">api_secret</span><span class="p">,</span> <span class="n">query_string</span><span class="p">)</span>

<span class="c1"># Headers for the GET request
</span><span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
<span class="s">'api-key'</span><span class="p">:</span> <span class="n">api_key</span><span class="p">,</span>
<span class="s">'signature'</span><span class="p">:</span> <span class="n">signature</span><span class="p">,</span>
<span class="s">'accept'</span><span class="p">:</span> <span class="s">'*/*'</span>
 <span class="p">}</span>

<span class="c1"># Construct the full URL including the path parameter for position status
</span><span class="n">full_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s">/v1/positions/</span><span class="si">{</span><span class="n">position_status</span><span class="si">}</span><span class="s">?sortOrder=</span><span class="si">{</span><span class="n">params</span><span class="p">[</span><span class="s">'sortOrder'</span><span class="p">]</span><span class="si">}</span><span class="s">&amp;pageSize=
</span><span class="si">{</span><span class="n">params</span><span class="p">[</span><span class="s">'pageSize'</span><span class="p">]</span><span class="si">}</span><span class="s">&amp;timestamp=</span><span class="si">{</span><span class="n">params</span><span class="p">[</span><span class="s">'timestamp'</span><span class="p">]</span><span class="si">}</span><span class="s">"</span>

<span class="k">try</span><span class="p">:</span>
<span class="c1"># Send the GET request to fetch positions
</span><span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">full_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="n">response</span><span class="p">.</span><span class="n">raise_for_status</span><span class="p">()</span> <span class="c1"># Raises an error for 4xx/5xx responses
</span><span class="n">response_data</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Positions fetched successfully:'</span><span class="p">,</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">response_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
<span class="k">except</span> <span class="n">requests</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Error: </span><span class="si">{</span><span class="n">err</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">text</span> <span class="k">if</span> <span class="n">err</span><span class="p">.</span><span class="n">response</span> <span class="k">else</span> <span class="n">err</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"An unexpected error occurred: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">getPosition</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">endpoint</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">/v1/positions</span><span class="dl">"</span><span class="p">;</span>
  <span class="kd">const</span> <span class="nx">positionId</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">sample-2c52-45cb-addf-9c1fde92fce5</span><span class="dl">"</span><span class="p">;</span>

  <span class="kd">const</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">positionId</span><span class="p">,</span>
  <span class="p">};</span>

  <span class="k">return</span> <span class="k">await</span> <span class="nx">getRequest</span><span class="p">(</span><span class="nx">endpoint</span><span class="p">,</span> <span class="nx">params</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="trade-history">Get User's Trade History</h2>

<p><code>GET /v1/user-data/trade-history</code></p>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">fetchUserTradeHistory</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">endpoint</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">/v1/user-data/trade-history</span><span class="dl">"</span><span class="p">;</span>
  <span class="kd">const</span> <span class="nx">startTimestamp</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">1696425435000</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// Optional</span>
  <span class="kd">const</span> <span class="nx">endTimestamp</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">1725451568979</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// Optional</span>
  <span class="kd">const</span> <span class="nx">sortOrder</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">desc</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// Optional</span>
  <span class="kd">const</span> <span class="nx">pageSize</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span> <span class="c1">// Optional</span>
  <span class="kd">const</span> <span class="nx">symbol</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">BTCINR</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// Optional</span>

<span class="kd">const</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{</span>
   <span class="c1">//Optional Params</span>
    <span class="na">pageSize</span><span class="p">:</span> <span class="nx">pageSize</span><span class="p">.</span><span class="nx">toString</span><span class="p">(),</span>
    <span class="na">sortOrder</span><span class="p">:</span> <span class="nx">sortOrder</span><span class="p">,</span>
    <span class="na">startTimestamp</span><span class="p">:</span> <span class="nx">startTimestamp</span><span class="p">,</span>
    <span class="na">endTimestamp</span><span class="p">:</span> <span class="nx">endTimestamp</span><span class="p">,</span>
    <span class="na">symbol</span><span class="p">:</span> <span class="nx">symbol</span><span class="p">,</span>
  <span class="p">};</span>

<span class="c1">// Call the getRequest function</span>
  <span class="k">return</span> <span class="k">await</span> <span class="nx">getRequest</span><span class="p">(</span><span class="nx">endpoint</span><span class="p">,</span> <span class="nx">params</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># Function to fetch trade history
</span><span class="k">def</span> <span class="nf">trade_history</span><span class="p">():</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>
    <span class="n">trade_history_url</span> <span class="o">=</span> <span class="s">"https://fapi.pi42.com/v1/user-data/trade-history"</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">sortOrder</span><span class="s">': '</span><span class="n">desc</span><span class="s">',
    '</span><span class="n">pageSize</span><span class="s">': 100,
    '</span><span class="n">timestamp</span><span class="s">': timestamp
 }

query_string = f"sortOrder={params['</span><span class="n">sortOrder</span><span class="s">']}&amp;pageSize={params['</span><span class="n">pageSize</span><span class="s">']}&amp;timestamp=
{params['</span><span class="n">timestamp</span><span class="s">']}"

 signature = generate_signature(api_secret, query_string)

 headers = {
    '</span><span class="n">api</span><span class="o">-</span><span class="n">key</span><span class="s">': api_key,
    '</span><span class="n">signature</span><span class="s">': signature,
    '</span><span class="n">accept</span><span class="s">': '</span><span class="o">*/*</span><span class="s">'
 }

try:
    response = requests.get(f"{trade_history_url}?{query_string}", headers=headers)
    response.raise_for_status()
    response_data = response.json()
    print('</span><span class="n">Trade</span> <span class="n">history</span> <span class="n">fetched</span> <span class="n">successfully</span><span class="p">:</span><span class="s">', json.dumps(response_data, indent=4))
except requests.exceptions.HTTPError as err:
    print(f"Failed {response.status_code}: {response.text}")
</span></code></pre></div>
<h2 id="get-transaction-history">Get User's Transaction History</h2>

<p><code>GET/v1/user-data/transaction-history</code></p>

<p>Fetches transaction history by sending a GET request to the endpoint.</p>
<div class="highlight"><pre class="highlight python tab-python"><code><span class="k">def</span> <span class="nf">get_transaction_history</span><span class="p">():</span>
    <span class="c1"># Default values for optional parameters
</span>    <span class="n">start_timestamp</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">end_timestamp</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">sort_order</span> <span class="o">=</span> <span class="s">'desc'</span>
    <span class="n">page_size</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="n">symbol</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">trade_id</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">position_id</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="c1"># Generate the current timestamp (used as part of the authentication/signing process)
</span>    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>

    <span class="c1"># Prepare query parameters with required and optional fields
</span>    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'sortOrder'</span><span class="p">:</span> <span class="n">sort_order</span><span class="p">,</span>
        <span class="s">'pageSize'</span><span class="p">:</span> <span class="n">page_size</span><span class="p">,</span>
        <span class="s">'timestamp'</span><span class="p">:</span> <span class="n">timestamp</span>
    <span class="p">}</span>

    <span class="c1"># Include optional parameters only if they are provided
</span>    <span class="k">if</span> <span class="n">start_timestamp</span><span class="p">:</span>
        <span class="n">params</span><span class="p">[</span><span class="s">'startTimestamp'</span><span class="p">]</span> <span class="o">=</span> <span class="n">start_timestamp</span>
    <span class="k">if</span> <span class="n">end_timestamp</span><span class="p">:</span>
        <span class="n">params</span><span class="p">[</span><span class="s">'endTimestamp'</span><span class="p">]</span> <span class="o">=</span> <span class="n">end_timestamp</span>
    <span class="k">if</span> <span class="n">symbol</span><span class="p">:</span>
        <span class="n">params</span><span class="p">[</span><span class="s">'symbol'</span><span class="p">]</span> <span class="o">=</span> <span class="n">symbol</span>
    <span class="k">if</span> <span class="n">trade_id</span><span class="p">:</span>
        <span class="n">params</span><span class="p">[</span><span class="s">'tradeId'</span><span class="p">]</span> <span class="o">=</span> <span class="n">trade_id</span>
    <span class="k">if</span> <span class="n">position_id</span><span class="p">:</span>
        <span class="n">params</span><span class="p">[</span><span class="s">'positionId'</span><span class="p">]</span> <span class="o">=</span> <span class="n">position_id</span>

    <span class="c1"># Convert the parameters to a query string to be signed
</span>    <span class="n">query_string</span> <span class="o">=</span> <span class="s">'&amp;'</span><span class="p">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s">=</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s">"</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">params</span><span class="p">.</span><span class="n">items</span><span class="p">()])</span>

    <span class="c1"># Generate the signature (assuming `generate_signature` is defined)
</span>    <span class="n">signature</span> <span class="o">=</span> <span class="n">generate_signature</span><span class="p">(</span><span class="n">api_secret</span><span class="p">,</span> <span class="n">query_string</span><span class="p">)</span>

    <span class="c1"># Headers for the GET request
</span>    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">api_key</span><span class="p">,</span>
        <span class="s">'signature'</span><span class="p">:</span> <span class="n">signature</span><span class="p">,</span>
        <span class="s">'accept'</span><span class="p">:</span> <span class="s">'*/*'</span>
    <span class="p">}</span>

    <span class="c1"># Construct the full URL with the query string
</span>    <span class="n">full_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s">/v1/user-data/transaction-history?</span><span class="si">{</span><span class="n">query_string</span><span class="si">}</span><span class="s">"</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Send the GET request to fetch transaction history
</span>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">full_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
        <span class="n">response</span><span class="p">.</span><span class="n">raise_for_status</span><span class="p">()</span>  <span class="c1"># Raises an error for HTTP 4xx/5xx responses
</span>        <span class="n">response_data</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'Transaction history fetched successfully:'</span><span class="p">,</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">response_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
    <span class="k">except</span> <span class="n">requests</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="c1"># Handle specific HTTP errors
</span>        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"HTTP Error: </span><span class="si">{</span><span class="n">err</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">text</span> <span class="k">if</span> <span class="n">err</span><span class="p">.</span><span class="n">response</span> <span class="k">else</span> <span class="s">'No response text'</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># Handle any other exceptions
</span>        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Failed </span><span class="si">{</span><span class="n">response</span><span class="p">.</span><span class="n">status_code</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">fetchUserTransactionHistory</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">endpoint</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">/v1/user-data/transaction-history</span><span class="dl">"</span><span class="p">;</span>

    <span class="c1">// Optional parameters for filtering and sorting the transaction history</span>
    <span class="kd">const</span> <span class="nx">startTimestamp</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">1696425435000</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// Start timestamp in milliseconds</span>
    <span class="kd">const</span> <span class="nx">endTimestamp</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">1725451568979</span><span class="dl">"</span><span class="p">;</span>   <span class="c1">// End timestamp in milliseconds</span>
    <span class="kd">const</span> <span class="nx">sortOrder</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">desc</span><span class="dl">"</span><span class="p">;</span>               <span class="c1">// Sorting order: "asc" or "desc"</span>
    <span class="kd">const</span> <span class="nx">pageSize</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>                   <span class="c1">// Number of records per page</span>
    <span class="kd">const</span> <span class="nx">symbol</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">BTCINR</span><span class="dl">"</span><span class="p">;</span>                <span class="c1">// Trading symbol, e.g., "BTCINR"</span>
    <span class="kd">const</span> <span class="nx">tradeId</span> <span class="o">=</span> <span class="mi">12</span><span class="p">;</span>                     <span class="c1">// Specific trade ID to filter</span>
    <span class="kd">const</span> <span class="nx">positionId</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">3d5f302b-2c52-45cb-addf-9c1fde92fce5</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// Specific position ID</span>

    <span class="c1">// Construct the query parameters object</span>
    <span class="kd">const</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">pageSize</span><span class="p">:</span> <span class="nx">pageSize</span><span class="p">.</span><span class="nx">toString</span><span class="p">(),</span>
        <span class="na">sortOrder</span><span class="p">:</span> <span class="nx">sortOrder</span><span class="p">,</span>
        <span class="na">startTimestamp</span><span class="p">:</span> <span class="nx">startTimestamp</span><span class="p">,</span>
        <span class="na">endTimestamp</span><span class="p">:</span> <span class="nx">endTimestamp</span><span class="p">,</span>
        <span class="na">symbol</span><span class="p">:</span> <span class="nx">symbol</span><span class="p">,</span>
        <span class="na">tradeId</span><span class="p">:</span> <span class="nx">tradeId</span><span class="p">,</span>
        <span class="na">positionId</span><span class="p">:</span> <span class="nx">positionId</span><span class="p">,</span>
    <span class="p">};</span>

    <span class="c1">// Call the getRequest function with the endpoint and query parameters</span>
    <span class="k">return</span> <span class="k">await</span> <span class="nx">getRequest</span><span class="p">(</span><span class="nx">endpoint</span><span class="p">,</span> <span class="nx">params</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h2 id='exchange-update-leverage'>Update Leverage</h2>

<p><code>POST /v1/exchange/update/leverage</code></p>

<p>Update the leverage preference for a specific trading contract</p>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">updateLeverage</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">endpoint</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">/v1/exchange/update/leverage</span><span class="dl">"</span><span class="p">;</span>

    <span class="kd">const</span> <span class="nx">leverage</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">contractName</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">BTCINR</span><span class="dl">"</span><span class="p">;</span>

    <span class="c1">// Prepare request payload</span>
    <span class="kd">const</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">leverage</span><span class="p">:</span> <span class="nx">leverage</span><span class="p">,</span>       <span class="c1">// Ensure leverage is an integer</span>
        <span class="na">contractName</span><span class="p">:</span> <span class="nx">contractName</span><span class="p">,</span>
    <span class="p">};</span>

    <span class="c1">// Call the postRequest function</span>
    <span class="k">return</span> <span class="k">await</span> <span class="nx">postRequest</span><span class="p">(</span><span class="nx">endpoint</span><span class="p">,</span> <span class="nx">params</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="k">def</span> <span class="nf">update_leverage</span><span class="p">():</span>
  <span class="n">leverage</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s">"Enter the leverage value: "</span><span class="p">))</span>
  <span class="n">contract_name</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Enter the contract name: "</span><span class="p">)</span>

  <span class="c1"># Generate the current timestamp
</span>  <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>

  <span class="c1"># Prepare the request body (JSON)
</span>  <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s">'leverage'</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">leverage</span><span class="p">),</span>
      <span class="s">'contractName'</span><span class="p">:</span> <span class="n">contract_name</span><span class="p">,</span>
      <span class="s">'timestamp'</span><span class="p">:</span> <span class="n">timestamp</span>
  <span class="p">}</span>

  <span class="c1"># Convert the request body to a JSON string for signing
</span>  <span class="n">data_to_sign</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">separators</span><span class="o">=</span><span class="p">(</span><span class="s">','</span><span class="p">,</span> <span class="s">':'</span><span class="p">))</span>

  <span class="c1"># Generate the signature
</span>  <span class="n">signature</span> <span class="o">=</span> <span class="n">generate_signature</span><span class="p">(</span><span class="n">api_secret</span><span class="p">,</span> <span class="n">data_to_sign</span><span class="p">)</span>

  <span class="c1"># Headers for the POST request
</span>  <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s">'api-key'</span><span class="p">:</span> <span class="n">api_key</span><span class="p">,</span>
      <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
      <span class="s">'signature'</span><span class="p">:</span> <span class="n">signature</span>
  <span class="p">}</span>

  <span class="c1"># Construct the full URL
</span>  <span class="n">update_leverage_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s">/v1/exchange/update/leverage"</span>

  <span class="k">try</span><span class="p">:</span>
      <span class="c1"># Send the POST request to update the leverage
</span>      <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">update_leverage_url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
      <span class="n">response</span><span class="p">.</span><span class="n">raise_for_status</span><span class="p">()</span> <span class="c1"># Raises an error for 4xx/5xx responses
</span>      <span class="n">response_data</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()</span>
      <span class="k">print</span><span class="p">(</span><span class="s">'Leverage updated successfully:'</span><span class="p">,</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">response_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
  <span class="k">except</span> <span class="n">requests</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
      <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Error: </span><span class="si">{</span><span class="n">err</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">text</span> <span class="k">if</span> <span class="n">err</span><span class="p">.</span><span class="n">response</span> <span class="k">else</span> <span class="n">err</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
  <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"An unexpected error occurred: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>


</code></pre></div>
<h2 id="delete-order"> Deleting an Order</h2>

<p><code>DELETE /v1/order/delete-order</code></p>

<p>Delete an existing order based on its clientOrderId</p>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">deleteOrder</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">endpoint</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">/v1/order/delete-order</span><span class="dl">"</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">clientOrderId</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">a9c5ba9893c99828e4b5-6238-ext</span><span class="dl">"</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">().</span><span class="nx">toString</span><span class="p">();</span>

    <span class="c1">// Prepare request payload</span>
    <span class="kd">const</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">clientOrderId</span><span class="p">:</span> <span class="nx">clientOrderId</span><span class="p">,</span>
        <span class="na">timestamp</span><span class="p">:</span> <span class="nx">timestamp</span><span class="p">,</span>
    <span class="p">};</span>

    <span class="c1">// Call the deleteRequest function</span>
    <span class="k">return</span> <span class="k">await</span> <span class="nx">deleteRequest</span><span class="p">(</span><span class="nx">endpoint</span><span class="p">,</span> <span class="nx">params</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="k">def</span> <span class="nf">delete_order</span><span class="p">():</span>
    <span class="n">client_order_id</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Enter the clientOrderId to delete: "</span><span class="p">)</span>
    <span class="n">delete_order_url</span> <span class="o">=</span> <span class="s">"https://fapi.pi42.com/v1/order/delete-order"</span>

    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>

    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'clientOrderId'</span><span class="p">:</span> <span class="n">client_order_id</span><span class="p">,</span>
        <span class="s">'timestamp'</span><span class="p">:</span> <span class="n">timestamp</span>
    <span class="p">}</span>

    <span class="n">data_to_sign</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">separators</span><span class="o">=</span><span class="p">(</span><span class="s">','</span><span class="p">,</span> <span class="s">':'</span><span class="p">))</span>
    <span class="n">signature</span> <span class="o">=</span> <span class="n">generate_signature</span><span class="p">(</span><span class="n">api_secret</span><span class="p">,</span> <span class="n">data_to_sign</span><span class="p">)</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">api_key</span><span class="p">,</span>
        <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
        <span class="s">'signature'</span><span class="p">:</span> <span class="n">signature</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">delete</span><span class="p">(</span><span class="n">delete_order_url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
        <span class="n">response</span><span class="p">.</span><span class="n">raise_for_status</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Order with clientOrderId </span><span class="si">{</span><span class="n">client_order_id</span><span class="si">}</span><span class="s"> deleted successfully."</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Failed </span><span class="si">{</span><span class="n">response</span><span class="p">.</span><span class="n">status_code</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div>

<h1 id='public-endpoints'>Public Endpoints</h1>

<p>Public endpoints in Pi42 are designed to facilitate easy access to various functionalities of the Pi42 platform, particularly for integration with external systems and applications. 
Below is an overview of the public endpoints available in Pi42, their typical uses, and example API calls.</p>

<h2 id='ticker-update-24hr'>Ticker Update (24Hr)</h2>

<p><code>GET /v1/market/ticker24Hr</code></p>

<p>Fetch the 24-hour market ticker data for a specific trading pair, in this case, &quot;BTCINR&quot;.</p>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">fetchTicker</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">endpoint</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">/v1/market/ticker24Hr/</span><span class="dl">"</span><span class="p">;</span>  <span class="c1">// API endpoint for fetching the 24-hour market ticker</span>
    <span class="kd">const</span> <span class="nx">contractPair</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">BTCINR</span><span class="dl">"</span><span class="p">;</span>              <span class="c1">// The trading pair for which the ticker data is being requested</span>
    <span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoint</span><span class="p">}${</span><span class="nx">contractPair</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>   <span class="c1">// Constructs the full URL by appending the trading pair to the endpoint</span>

    <span class="c1">// Call the getRequest function with the constructed URL</span>
    <span class="k">return</span> <span class="k">await</span> <span class="nx">getRequest</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="p">{});</span>
<span class="p">}</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="k">def</span> <span class="nf">get_24hr_ticker_update</span><span class="p">():</span>
    <span class="c1"># Get the contract pair input from the user
</span>    <span class="n">contract_pair</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Enter the contract pair (e.g., btc, eth): "</span><span class="p">).</span><span class="n">lower</span><span class="p">()</span>

    <span class="c1"># Validate the input
</span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">contract_pair</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Invalid contract pair. Please enter a valid contract pair (e.g., btc, eth)."</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># Construct the full URL for the API request using the provided contract pair
</span>    <span class="n">full_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"https://api.pi42.com/v1/market/ticker24Hr/</span><span class="si">{</span><span class="n">contract_pair</span><span class="si">}</span><span class="s">"</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Send the GET request to the API
</span>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">full_url</span><span class="p">)</span>
        <span class="n">response</span><span class="p">.</span><span class="n">raise_for_status</span><span class="p">()</span>  <span class="c1"># Raise an error for HTTP 4xx/5xx responses
</span>
        <span class="c1"># Parse the JSON response data
</span>        <span class="n">response_data</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()</span>

        <span class="c1"># Print the 24-hour ticker update in a formatted manner
</span>        <span class="k">print</span><span class="p">(</span><span class="s">'24-hour ticker update fetched successfully:'</span><span class="p">,</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">response_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
    <span class="k">except</span> <span class="n">requests</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="c1"># Handle HTTP errors specifically
</span>        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Error: </span><span class="si">{</span><span class="n">err</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">text</span> <span class="k">if</span> <span class="n">err</span><span class="p">.</span><span class="n">response</span> <span class="k">else</span> <span class="n">err</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># Handle any other unexpected errors
</span>        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"An unexpected error occurred: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>


</code></pre></div>
<h2 id='agg-trade-update'>Aggregate Trade Update</h2>

<p><code>GET /v1/market/aggTrade</code></p>

<p>Fetch the aggregated trade data for a specific trading pair, in this case, &quot;BTCINR&quot;. </p>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">fetchAggTrade</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">endpoint</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">/v1/market/aggTrade/</span><span class="dl">"</span><span class="p">;</span>   <span class="c1">// Define the API endpoint for aggregated trades</span>
    <span class="kd">const</span> <span class="nx">contractPair</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">BTCINR</span><span class="dl">"</span><span class="p">;</span>             <span class="c1">// Specify the trading pair (e.g., Bitcoin to Indian Rupee)</span>
    <span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoint</span><span class="p">}${</span><span class="nx">contractPair</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>  <span class="c1">// Construct the full URL by appending the trading pair to the endpoint</span>

    <span class="c1">// Call the getRequest function to send the GET request to the API</span>
    <span class="k">return</span> <span class="k">await</span> <span class="nx">getRequest</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="p">{});</span>
<span class="p">}</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="k">def</span> <span class="nf">get_trade_updates</span><span class="p">():</span>
    <span class="c1"># Prompt the user to enter a contract pair
</span>    <span class="n">contract_pair</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Enter the contract pair (e.g., btc, eth): "</span><span class="p">).</span><span class="n">lower</span><span class="p">()</span>

    <span class="c1"># Validate the user input
</span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">contract_pair</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Invalid contract pair. Please enter a valid contract pair (e.g., btc, eth)."</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># Construct the URL for the API request using the provided contract pair
</span>    <span class="n">full_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"https://api.pi42.com/v1/market/aggTrade/</span><span class="si">{</span><span class="n">contract_pair</span><span class="si">}</span><span class="s">"</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Send the GET request to fetch trade updates
</span>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">full_url</span><span class="p">)</span>
        <span class="n">response</span><span class="p">.</span><span class="n">raise_for_status</span><span class="p">()</span>  <span class="c1"># Raise an exception for HTTP error responses
</span>
        <span class="c1"># Parse the JSON response data
</span>        <span class="n">response_data</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()</span>

        <span class="c1"># Print the trade updates in a formatted manner
</span>        <span class="k">print</span><span class="p">(</span><span class="s">'Trade updates fetched successfully:'</span><span class="p">,</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">response_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
    <span class="k">except</span> <span class="n">requests</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="c1"># Handle HTTP errors specifically
</span>        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Error: </span><span class="si">{</span><span class="n">err</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">text</span> <span class="k">if</span> <span class="n">err</span><span class="p">.</span><span class="n">response</span> <span class="k">else</span> <span class="n">err</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># Handle any other unexpected errors
</span>        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"An unexpected error occurred: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

</code></pre></div>
<h2 id='depth-update'>Depth Update</h2>

<p><code>GET /v1/market/depth/</code></p>

<p>Retrieves the order book depth data for a specified trading pair and interval.</p>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">fetchDepth</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">endpoint</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">/v1/market/depth/</span><span class="dl">"</span><span class="p">;</span>   <span class="c1">// API endpoint for fetching order book depth data</span>
    <span class="kd">const</span> <span class="nx">contractPair</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">BTCINR</span><span class="dl">"</span><span class="p">;</span>           <span class="c1">// Trading pair for which the depth data is requested</span>
    <span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">endpoint</span><span class="p">}${</span><span class="nx">contractPair</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span> <span class="c1">// Constructs the full URL by appending the trading pair to the endpoint</span>

    <span class="c1">// Call the getRequest function with the constructed URL</span>
    <span class="k">return</span> <span class="k">await</span> <span class="nx">getRequest</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="p">{});</span>
<span class="p">}</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="k">def</span> <span class="nf">get_depth_update</span><span class="p">():</span>
    <span class="c1"># Prompt the user to enter a contract pair
</span>    <span class="n">contract_pair</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Enter the contract pair (e.g., btc, eth): "</span><span class="p">).</span><span class="n">lower</span><span class="p">()</span>

    <span class="c1"># Validate the user input
</span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">contract_pair</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Invalid contract pair. Please enter a valid contract pair (e.g., btc, eth)."</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># Construct the URL for the API request using the provided contract pair
</span>    <span class="n">full_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"https://api.pi42.com/v1/market/depth/</span><span class="si">{</span><span class="n">contract_pair</span><span class="si">}</span><span class="s">"</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Send the GET request to fetch depth updates
</span>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">full_url</span><span class="p">)</span>
        <span class="n">response</span><span class="p">.</span><span class="n">raise_for_status</span><span class="p">()</span>  <span class="c1"># Raises an error for 4xx/5xx responses
</span>
        <span class="c1"># Parse the JSON response data
</span>        <span class="n">response_data</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()</span>

        <span class="c1"># Print the depth update in a formatted manner
</span>        <span class="k">print</span><span class="p">(</span><span class="s">'Depth update fetched successfully:'</span><span class="p">,</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">response_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
    <span class="k">except</span> <span class="n">requests</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="c1"># Handle HTTP errors specifically
</span>        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Error: </span><span class="si">{</span><span class="n">err</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">text</span> <span class="k">if</span> <span class="n">err</span><span class="p">.</span><span class="n">response</span> <span class="k">else</span> <span class="n">err</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># Handle any other unexpected errors
</span>        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"An unexpected error occurred: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div>
<h2 id='klines'>Get Klines</h2>

<p><code>POST /v1/market/klines</code></p>

<p>Retrieves candlestick (Kline) data for a specific trading pair.</p>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">getKlines</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">endpoint</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">/v1/market/klines</span><span class="dl">"</span><span class="p">;</span>

    <span class="c1">// Define the fixed values for positionId and amount (though not used in this function)</span>
    <span class="kd">const</span> <span class="nx">positionId</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">18c6c979-b089-4e67-b627-4c2072d0d5cb</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// Replace with your actual position ID</span>
    <span class="kd">const</span> <span class="nx">amount</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// Replace with the actual amount you want to add</span>

    <span class="c1">// Prepare request payload</span>
    <span class="kd">const</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">pair</span><span class="p">:</span> <span class="dl">"</span><span class="s2">BTCINR</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">interval</span><span class="p">:</span> <span class="dl">"</span><span class="s2">1m</span><span class="dl">"</span><span class="p">,</span>
        <span class="c1">// Optional</span>
        <span class="na">startTime</span><span class="p">:</span> <span class="mi">1696425435000</span><span class="p">,</span>
        <span class="na">endTime</span><span class="p">:</span> <span class="mi">1696425435999</span><span class="p">,</span>
        <span class="na">limit</span><span class="p">:</span> <span class="mi">1000</span>
    <span class="p">};</span>

    <span class="c1">// Call the postRequest function</span>
    <span class="k">return</span> <span class="k">await</span> <span class="nx">postRequest</span><span class="p">(</span><span class="nx">endpoint</span><span class="p">,</span> <span class="nx">params</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="k">def</span> <span class="nf">get_kline_data</span><span class="p">():</span>
  <span class="k">try</span><span class="p">:</span>
      <span class="c1"># User inputs
</span>      <span class="n">pair</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Enter the trading pair (e.g., BTCINR): "</span><span class="p">).</span><span class="n">upper</span><span class="p">()</span>
      <span class="n">interval</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Enter the interval (e.g., 1m, 5m, 1h): "</span><span class="p">).</span><span class="n">lower</span><span class="p">()</span>

      <span class="c1"># Prepare the request body (JSON)
</span>      <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
          <span class="s">'pair'</span><span class="p">:</span> <span class="n">pair</span><span class="p">,</span>
          <span class="s">'interval'</span><span class="p">:</span> <span class="n">interval</span><span class="p">,</span>
          <span class="s">'limit'</span><span class="p">:</span> <span class="mi">1000</span>
      <span class="p">}</span>

      <span class="c1"># Headers for the POST request (no API key or signature required)
</span>      <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
          <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span>
      <span class="p">}</span>

      <span class="c1"># Construct the full URL for the Kline endpoint
</span>      <span class="n">kline_url</span> <span class="o">=</span> <span class="s">"https://api.pi42.com/v1/market/klines"</span>

      <span class="c1"># Send the POST request to get Kline data
</span>      <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">kline_url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
      <span class="n">response</span><span class="p">.</span><span class="n">raise_for_status</span><span class="p">()</span> <span class="c1"># Raises an error for 4xx/5xx responses
</span>      <span class="n">response_data</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()</span>
      <span class="k">print</span><span class="p">(</span><span class="s">'Kline data fetched successfully:'</span><span class="p">,</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">response_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>

  <span class="k">except</span> <span class="nb">ValueError</span><span class="p">:</span>
      <span class="k">print</span><span class="p">(</span><span class="s">"Please enter valid inputs for pair, interval."</span><span class="p">)</span>
  <span class="k">except</span> <span class="n">requests</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
      <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Error: </span><span class="si">{</span><span class="n">err</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">text</span> <span class="k">if</span> <span class="n">err</span><span class="p">.</span><span class="n">response</span> <span class="k">else</span> <span class="n">err</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
  <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"An unexpected error occurred: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div>

<h1 id='web-sockets'>Web Sockets</h1>

<h2 id="create-listen-key"> Create Listen Key </h2>

<p>Users can create a Listen Key for each API key. By default each listen key will be valid for 60 minutes.</p>

<p><code>POST /v1/retail/listen-key</code></p>
<div class="highlight"><pre class="highlight plaintext"><code>const baseUrl = process.env.PI42_BASE_URL + '/v1/retail/listen-key';

// Function to generate a signature for the request
const generateSignature = (params: object, apiSecret: string) =&gt; {
  return crypto
    .createHmac('sha256', apiSecret)
    .update(JSON.stringify(params))
    .digest('hex');
};

// Function to call Create Listen Key API
async function createListenKey(apiKey: string, apiSecret: string) {
  const params = {
    timestamp: Date.now().toString(),
  };

  const signature = generateSignature(params, apiSecret);

  try {
    const response = await axios.post(baseUrl, params, {
      headers: {
        'api-key': apiKey,
        'Content-Type': 'application/json',
        'signature': signature,
      },
    });
    console.log('Create Listen Key Response:', response.data);
    return response.data.listenKey;
  } catch (error) {
    console.error(
      'Error creating Listen Key:',
      error.response ? error.response.data : error.message
    );
    throw error; // Rethrow the error for further handling
  }
}
</code></pre></div>
<h2 id="authenticated-web-sockets">Authenticated Web Sockets</h2>

<p>Authenticated Web Socket stream base URL <code>https://fawss.pi42.com/auth-stream</code></p>

<p>Event listeners are described below:</p>
<div class="highlight"><pre class="highlight plaintext"><code>const serverUrl = `https://fawss.pi42.com/auth-stream/${listenKey}`;

// Create a new socket connection
const socket = io(serverUrl);

// Event listener for when the connection is open
socket.on('connect', () =&gt; {
  console.log('Connected to WebSocket server');
});

// Event listener for messages from the server

// Event listener for newPosition events
socket.on('newPosition', (data: any) =&gt; {
  console.log('New position received:', data);
});

// Listen for order filled event
socket.on('orderFilled', (data: any) =&gt; {
  console.log('Order filled:', data);
});

// Listen for order partially filled event
socket.on('orderPartiallyFilled', (data: any) =&gt; {
  console.log('Order partially filled:', data);
});

// Listen for order cancelled event
socket.on('orderCancelled', (data: any) =&gt; {
  console.log('Order cancelled:', data);
});

// Listen for order failed event
socket.on('orderFailed', (data: any) =&gt; {
  console.log('Order failed:', data);
});

// Listen for new order event
socket.on('newOrder', (data: any) =&gt; {
  console.log('New order:', data);
});

// Listen for update position event
socket.on('updatePosition', (data: any) =&gt; {
  console.log('Position updated:', data);
});

// Listen for close position event
socket.on('closePosition', (data: any) =&gt; {
  console.log('Position closed:', data);
});

// Listen for balance update event
socket.on('balanceUpdate', (data: any) =&gt; {
  console.log('Balance updated:', data);
});

// Listen for new trade event
socket.on('newTrade', (data: any) =&gt; {
  console.log('New trade:', data);
});

// Listen for session expiry
socket.on('sessionExpired', (data: any) =&gt; {
  console.log('Session Expired:', data);
});

// Event listener for when the connection is closed
socket.on('disconnect', () =&gt; {
  console.log('Disconnected from WebSocket server');
});
</code></pre></div>
<h2 id="public-web-sockets">Public Web Sockets</h2>

<p>Public Web Socket URL <code>https://fawss.pi42.com/</code>. Once connected, users can subscribe to different topics mentioned below:</p>

<table>
    <thead>
        <tr>
            <th>Parameter</th>
            <th>Example</th>
            <th>Listening Topic</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>contract_pair@depth_minGrouping</td>
            <td>btcinr@depth
            _
            0.1</td>
            <td>depthUpdate</td>
        </tr>
        <tr>
            <td>contract
            _pair@kline
            _
            interval</td>
            <td>btcinr@kline
            _
            1m</td>
            <td>kline</td>
        </tr>
        <tr>
            <td>contract
            _pair@markPrice</td>
            <td>btcinr@markPrice</td>
            <td>markPriceUpdate</td>
        </tr>
        <tr>
            <td>contract
            _pair@aggTrade</td>
            <td>btcinr@aggTrade</td>
            <td>aggTrade</td>
        </tr>
        <tr>
            <td>contract
            _pair@ticker</td>
            <td>btcinr@ticker</td>
            <td>24hrTicker</td>
        </tr>
        <tr>
            <td>contract
            _pair@marketInfo</td>
            <td>btcinr@marketInfo</td>
            <td>marketInfo</td>
        </tr>
        <tr>
            <td>markPriceArr</td>
            <td>N/A</td>
            <td>markPriceArr</td>
        </tr>
        <tr>
            <td>tickerArr</td>
            <td>N/A</td>
            <td>tickerArr</td>
        </tr>
        <tr>
            <td>All contracts details</td>
            <td>N/A</td>
            <td>allContractDetails</td>
        </tr>
</table>

<ul>
<li>Intervals: The intervals for kline (candlestick) data can be <code>1m</code>, <code>3m</code>, <code>5m</code>, <code>15m</code>, <code>30m</code>, <code>1h</code>, <code>2h</code>, <code>4h</code>, <code>6h</code>, <code>8h</code>, <code>12h</code>, <code>1d</code>, <code>3d</code>, <code>1w</code>, <code>1M</code>.</li>
<li>MinGroupings: Depth groupings vary by contract. For example, 0.1 is used for BTC.</li>
</ul>

<div class="highlight"><pre class="highlight plaintext"><code>import { io } from 'socket.io-client';

// WebSocket server URL
const serverUrl = 'https://fawss.pi42.com/';

// Create a new socket connection
const socket = io(serverUrl);

// Event listener for when the connection is open
socket.on('connect', () =&gt; {
  console.log('Connected to WebSocket server');
  subscribeToTopics();
});

// Event listener for when the connection is closed
socket.on('disconnect', () =&gt; {
  console.log('Disconnected from WebSocket server');
});

// Event listener for errors
socket.on('error', (error: any) =&gt; {
  console.error('Socket.IO error:', error);
});

// Function to subscribe to various WebSocket topics
function subscribeToTopics() {
  const topics = ['btcinr@depth_0.1', 'btcinr@markPrice']; // List of topics you want to subscribe to

  // Subscribe to each topic
  socket.emit('subscribe', {
    params: topics, // Sends the topics array to the WebSocket server
  });

  // Event listener for updates on various data topics
  socket.on('depthUpdate', (data) =&gt; {
    console.log('depthUpdate: ', data);
  });

  socket.on('kline', (data) =&gt; {
    console.log('kline: ', data);
  });

  socket.on('markPriceUpdate', (data) =&gt; {
    console.log('markPriceUpdate: ', data);
  });

  socket.on('aggTrade', (data) =&gt; {
    console.log('aggTrade: ', data);
  });

  socket.on('24hrTicker', (data) =&gt; {
    console.log('24hrTicker: ', data);
  });

  socket.on('marketInfo', (data) =&gt; {
    console.log('marketInfo: ', data);
  });

  socket.on('markPriceArr', (data) =&gt; {
    console.log('markPriceArr: ', data);
  });

  socket.on('tickerArr', (data) =&gt; {
    console.log('tickerArr: ', data);
  });

  socket.on('marginRate', (data) =&gt; {
    console.log('marginRate: ', data);
  });
}
</code></pre></div>

<h2 id="get-listen-key">Get Listen Key</h2>

<p><code>POST /v1/retail/listen-key</code></p>

<p>Obtain a WebSocket listen key from the endpoint. </p>

<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">getListenKey</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">endpoint</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">/v1/retail/listen-key</span><span class="dl">"</span><span class="p">;</span>

    <span class="c1">// Call the postRequest function</span>
    <span class="k">return</span> <span class="k">await</span> <span class="nx">postRequest</span><span class="p">(</span><span class="nx">endpoint</span><span class="p">,</span> <span class="p">{});</span>
<span class="p">}</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="k">def</span> <span class="nf">create_or_update_listen_key</span><span class="p">():</span>
  <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>

  <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s">'timestamp'</span><span class="p">:</span> <span class="n">timestamp</span>
  <span class="p">}</span>

  <span class="c1"># Convert the parameters to a query string (if signing a query string)
</span>  <span class="n">data_to_sign</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">separators</span><span class="o">=</span><span class="p">(</span><span class="s">','</span><span class="p">,</span> <span class="s">':'</span><span class="p">))</span>
  <span class="n">signature</span> <span class="o">=</span> <span class="n">generate_signature</span><span class="p">(</span><span class="n">api_secret</span><span class="p">,</span> <span class="n">data_to_sign</span><span class="p">)</span>

  <span class="c1"># Headers for the request
</span>  <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s">'api-key'</span><span class="p">:</span> <span class="n">api_key</span><span class="p">,</span>
      <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
      <span class="s">'signature'</span><span class="p">:</span> <span class="n">signature</span><span class="p">,</span>
  <span class="p">}</span>

  <span class="k">try</span><span class="p">:</span>
      <span class="c1"># Send the POST request to create or update a listen key
</span>      <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">listen_key_url</span><span class="si">}</span><span class="s">'</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
      <span class="n">response</span><span class="p">.</span><span class="n">raise_for_status</span><span class="p">()</span>
      <span class="n">response_data</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()</span>
      <span class="k">print</span><span class="p">(</span><span class="s">'Listen key created or updated successfully:'</span><span class="p">,</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">response_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
  <span class="k">except</span> <span class="n">requests</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
      <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Failed </span><span class="si">{</span><span class="n">response</span><span class="p">.</span><span class="n">status_code</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

</code></pre></div>

<h2 id="update-listen-key">Update Listen Key</h2>

<p><code>PUT /v1/retail/listen-key</code></p>

<p>Update the expiry of a listen key.</p>

<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">updateListenKey</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">endpoint</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">/v1/retail/listen-key</span><span class="dl">"</span><span class="p">;</span>

    <span class="c1">// Call the getRequest function</span>
    <span class="k">return</span> <span class="k">await</span> <span class="nx">putRequest</span><span class="p">(</span><span class="nx">endpoint</span><span class="p">,</span> <span class="p">{});</span>
<span class="p">}</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="k">def</span> <span class="nf">update_listen_key_expiry</span><span class="p">():</span>
  <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>

  <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s">'timestamp'</span><span class="p">:</span> <span class="n">timestamp</span>
  <span class="p">}</span>

  <span class="n">data_to_sign</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">separators</span><span class="o">=</span><span class="p">(</span><span class="s">','</span><span class="p">,</span> <span class="s">':'</span><span class="p">))</span>

  <span class="c1"># Generate the signature using the provided helper function
</span>  <span class="n">signature</span> <span class="o">=</span> <span class="n">generate_signature</span><span class="p">(</span><span class="n">api_secret</span><span class="p">,</span> <span class="n">data_to_sign</span><span class="p">)</span>

  <span class="c1"># Headers for the PUT request
</span>  <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s">'api-key'</span><span class="p">:</span> <span class="n">api_key</span><span class="p">,</span>
      <span class="s">'signature'</span><span class="p">:</span> <span class="n">signature</span><span class="p">,</span>
  <span class="p">}</span>

  <span class="k">try</span><span class="p">:</span>
      <span class="c1"># Send the PUT request to update the listen key expiry
</span>      <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">put</span><span class="p">(</span><span class="n">listen_key_url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
      <span class="k">print</span><span class="p">(</span><span class="s">'Listen key expiry updated successfully:'</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
  <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Failed </span><span class="si">{</span><span class="n">response</span><span class="p">.</span><span class="n">status_code</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div>

<h2 id="delete-listen-key">Delete Listen Key</h2>

<p><code>DELETE /v1/retail/listen-key</code></p>

<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">deleteListenKey</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">endpoint</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">/v1/retail/listen-key</span><span class="dl">"</span><span class="p">;</span>

    <span class="c1">// Call the deleteRequest function</span>
    <span class="k">return</span> <span class="k">await</span> <span class="nx">deleteRequest</span><span class="p">(</span><span class="nx">endpoint</span><span class="p">,</span> <span class="p">{});</span>
<span class="p">}</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="k">def</span> <span class="nf">delete_listen_key</span><span class="p">():</span>
  <span class="c1"># Generate the current timestamp
</span>  <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>

  <span class="c1"># Prepare the data for the request (listenKey is passed in the URL path)
</span>  <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s">'timestamp'</span><span class="p">:</span> <span class="n">timestamp</span>
  <span class="p">}</span>

  <span class="c1"># Generate the signature based on the params
</span>  <span class="n">data_to_sign</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">separators</span><span class="o">=</span><span class="p">(</span><span class="s">','</span><span class="p">,</span> <span class="s">':'</span><span class="p">))</span>
  <span class="n">signature</span> <span class="o">=</span> <span class="n">generate_signature</span><span class="p">(</span><span class="n">api_secret</span><span class="p">,</span> <span class="n">data_to_sign</span><span class="p">)</span>

  <span class="c1"># Headers for the DELETE request
</span>  <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s">'api-key'</span><span class="p">:</span> <span class="n">api_key</span><span class="p">,</span>
      <span class="s">'signature'</span><span class="p">:</span> <span class="n">signature</span><span class="p">,</span>
      <span class="s">'accept'</span><span class="p">:</span> <span class="s">'*/*'</span>
  <span class="p">}</span>

  <span class="c1"># Construct the full URL, inserting the listenKey into the path
</span>  <span class="n">delete_listen_key_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s">/v1/retail/listen-key/"</span>

  <span class="k">try</span><span class="p">:</span>
      <span class="c1"># Send the DELETE request to delete the listen key
</span>      <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">delete</span><span class="p">(</span><span class="n">delete_listen_key_url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
      <span class="n">response</span><span class="p">.</span><span class="n">raise_for_status</span><span class="p">()</span> <span class="c1"># Raises an error for 4xx/5xx responses
</span>      <span class="k">print</span><span class="p">(</span><span class="s">'Listen key deleted successfully.'</span><span class="p">)</span>
  <span class="k">except</span> <span class="n">requests</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
      <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Error: </span><span class="si">{</span><span class="n">err</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">text</span> <span class="k">if</span> <span class="n">err</span><span class="p">.</span><span class="n">response</span> <span class="k">else</span> <span class="n">err</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
  <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"An unexpected error occurred: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div>

<h1 id="error-codes"> Error Codes </h1>

<p>Pi42 APIs utilize a set of custom error codes, each associated with an HTTP status code and a specific error message. These codes help users pinpoint the exact issue that caused the request to fail.</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>HTTP Status Code</th>
<th>Error Message</th>
<th>API Endpoints</th>
</tr>
</thead><tbody>
<tr>
<td>2303 </td>
<td>400</td>
<td>Contract pair not found</td>
<td>v1/exchange/update/leverage</td>
</tr>
<tr>
<td>2304 </td>
<td>400 </td>
<td>Leverage value out of range </td>
<td>v1/exchange/update/leverage</td>
</tr>
<tr>
<td>2305</td>
<td>400</td>
<td>Leverage cannot be updated with open
position </td>
<td>v1/exchange/update/leverage</td>
</tr>
<tr>
<td>2306 </td>
<td>400</td>
<td>Leverage cannot be updated with open
orders</td>
<td>v1/exchange/update/leverage</td>
</tr>
<tr>
<td>2307 </td>
<td>500</td>
<td>Unable to update user leverage
preference </td>
<td>v1/exchange/update/leverage</td>
</tr>
<tr>
<td>2400</td>
<td>400</td>
<td>Interval value is invalid </td>
<td>v1/market/klines</td>
</tr>
<tr>
<td>2401 </td>
<td>500</td>
<td>Unable to fetch kline data</td>
<td>v1/market/klines</td>
</tr>
<tr>
<td>2402 </td>
<td>400</td>
<td>Invalid contract pair</td>
<td>v1/market/depth/{contractPair}<br/>
v1/market/aggTrade/{contractPair} <br/>
v1/market/ticker24Hr/{contractPair}</td>
</tr>
<tr>
      <td>2403</td>
      <td>500</td>
      <td>Unable to fetch depth update for given contract pair</td>
      <td>v1/market/depth/{contractPair}</td>
    </tr>
    <tr>
      <td>2404</td>
      <td>500</td>
      <td>Unable to fetch trade update for given contract pair</td>
      <td>v1/market/aggTrade/{contractPair}</td>
    </tr>
    <tr>
      <td>2405</td>
      <td>500</td>
      <td>Unable to fetch 24 hr ticker update for given contract pair</td>
      <td>v1/market/ticker24Hr/{contractPair}</td>
    </tr>
    <tr>
      <td>2406</td>
      <td>400</td>
      <td>Invalid market is provided</td>
      <td>v1/market/marketInfo</td>
    </tr>
    <tr>
      <td>2407</td>
      <td>500</td>
      <td>Unable to fetch market information</td>
      <td>v1/market/marketInfo</td>
    </tr>
    <tr>
      <td>2500</td>
      <td>400</td>
      <td>Account id not found</td>
      <td>v1/positions/{positionStatus}</td>
    </tr>
    <tr>
      <td>2501</td>
      <td>500</td>
      <td>Unable to fetch positions</td>
      <td>v1/positions/{positionStatus}</td>
    </tr>
    <tr>
      <td>2502</td>
      <td>400</td>
      <td>No position exists with provided position id</td>
      <td>v1/positions</td>
    </tr>
    <tr>
      <td>2503</td>
      <td>400</td>
      <td>Invalid contract pair</td>
      <td>v1/positions</td>
    </tr>
    <tr>
      <td>2504</td>
      <td>500</td>
      <td>Unable to fetch position for provided position id</td>
      <td>v1/positions</td>
    </tr>
    <tr>
      <td>3000</td>
      <td>400</td>
      <td>Incorrect device type in header values</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>3001</td>
      <td>400</td>
      <td>Symbol is missing</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>3003</td>
      <td>400</td>
      <td>Invalid leverage</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>3004</td>
      <td>400</td>
      <td>Invalid order side</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>3005</td>
      <td>400</td>
      <td>Order price not present</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>3006</td>
      <td>400</td>
      <td>Quantity precision should be less than {value}</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>3007</td>
      <td>400</td>
      <td>Price precision should be less than {value}</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>3008</td>
      <td>400</td>
      <td>Limit price is required</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>3009</td>
      <td>400</td>
      <td>Limit price is out of allowed values</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>3010</td>
      <td>400</td>
      <td>Order quantity is out of range</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>3011</td>
      <td>400</td>
      <td>Order declined, TP/SL will be activated instantly</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>3012</td>
      <td>400</td>
      <td>Margin asset {asset} is not supported for this contract</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>3013</td>
      <td>400</td>
      <td>Order placement for this contract pair is not allowed as there is already an open order</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>3014</td>
      <td>400</td>
      <td>Order placement for this contract pair is not allowed as there is already an open position</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>3015</td>
      <td>400</td>
      <td>Take profit/Stop loss orders cannot be placed while reducing position</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>3018</td>
      <td>400</td>
      <td>Insufficient margin</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>3019</td>
      <td>400</td>
      <td>Ref id already exists</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>3021</td>
      <td>400</td>
      <td>Position id is missing</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>3022</td>
      <td>400</td>
      <td>Position not found</td>
      <td>v1/order/place-order<br>v1/order/add-margin<br>v1/order/reduce-margin</td>
    </tr>
    <tr>
      <td>3023</td>
      <td>400</td>
      <td>Stop loss order quantity out of range</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>3024</td>
      <td>400</td>
      <td>Take profit order quantity out of range</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>3025</td>
      <td>400</td>
      <td>Quantity being placed is out of range</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>3026</td>
      <td>400</td>
      <td>TP/SL is not allowed</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>3027</td>
      <td>400</td>
      <td>At least one of TP/SL price should be provided</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>3028</td>
      <td>400</td>
      <td>TP/SL price is out of range</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>3029</td>
      <td>500</td>
      <td>Order placement failed</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>3030</td>
      <td>500</td>
      <td>Failed to fetch open orders</td>
      <td>v1/order/open-orders</td>
    </tr>
    <tr>
      <td>3031</td>
      <td>400</td>
      <td>Bad client order id</td>
      <td>v1/order/delete-order</td>
    </tr>
    <tr>
      <td>3032</td>
      <td>500</td>
      <td>Failed to delete order</td>
      <td>v1/order/delete-order</td>
    </tr>
    <tr>
      <td>3033</td>
      <td>500</td>
      <td>Failed to fetch order history</td>
      <td>v1/order/order-history</td>
    </tr>
    <tr>
      <td>3034</td>
      <td>400</td>
      <td>Precision error</td>
      <td>v1/order/add-margin<br>v1/order/reduce-margin</td>
    </tr>
    <tr>
      <td>3035</td>
      <td>500</td>
      <td>Failed to add margin</td>
      <td>v1/order/add-margin</td>
    </tr>
    <tr>
      <td>3036</td>
      <td>400</td>
      <td>Margin reduction is invalid</td>
      <td>v1/order/reduce-margin</td>
    </tr>
    <tr>
      <td>3037</td>
      <td>500</td>
      <td>Failed to reduce margin</td>
      <td>v1/order/reduce-margin</td>
    </tr>
    <tr>
      <td>3038</td>
      <td>400</td>
      <td>INR wallet not found for provided account id</td>
      <td>v1/order/place-order<br>v1/order/add-margin<br>v1/order/reduce-margin</td>
    </tr>
    <tr>
      <td>3039</td>
      <td>400</td>
      <td>Insufficient funds available</td>
      <td>v1/order/place-order<br>v1/order/add-margin<br>v1/order/reduce-margin</td>
    </tr>
    <tr>
      <td>3040</td>
      <td>500</td>
      <td>Failed to fetch linked orders for provided link id</td>
      <td>v1/order/linked-orders/{linkId}</td>
    </tr>
    <tr>
      <td>3041</td>
      <td>400</td>
      <td>Invalid contract pair</td>
      <td>v1/order<br>v1/order/ref-id</td>
    </tr>
    <tr>
      <td>3042</td>
      <td>400</td>
      <td>No order exists with provided client order id</td>
      <td>v1/order</td>
    </tr>
    <tr>
      <td>3043</td>
      <td>500</td>
      <td>Failed to fetch order</td>
      <td>v1/order</td>
    </tr>
    <tr>
      <td>3044</td>
      <td>400</td>
      <td>No orders found with provided reference id</td>
      <td>v1/order/ref-id</td>
    </tr>
    <tr>
      <td>3045</td>
      <td>500</td>
      <td>Failed to fetch orders with provided reference id</td>
      <td>v1/order/ref-id</td>
    </tr>
    <tr>
      <td>3046</td>
      <td>500</td>
      <td>Failed to fetch margin history</td>
      <td>v1/order/fetch-margin-history</td>
    </tr>
    <tr>
      <td>3047</td>
      <td>500</td>
      <td>Failed to fetch market price</td>
      <td>v1/order/reduce-margin</td>
    </tr>
    <tr>
      <td>3048</td>
      <td>400</td>
      <td>Stop price should be present for stop orders</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>3049</td>
      <td>500</td>
      <td>Failed to build order metadata from position</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>3050</td>
      <td>400</td>
      <td>KYC verification pending</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>3051</td>
      <td>400</td>
      <td>Bank account verification pending</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>3052</td>
      <td>400</td>
      <td>Trade is not enabled</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>4000</td>
      <td>400</td>
      <td>Signature not found</td>
      <td>All retail APIs</td>
    </tr>
    <tr>
      <td>4001</td>
      <td>400</td>
      <td>Endpoint not supported</td>
      <td>All retail APIs</td>
    </tr>
    <tr>
      <td>4002</td>
      <td>403</td>
      <td>Unable to find user details</td>
      <td>All retail APIs</td>
    </tr>
    <tr>
      <td>4003</td>
      <td>403</td>
      <td>API key not verified</td>
      <td>All retail APIs</td>
    </tr>
    <tr>
      <td>4004</td>
      <td>403</td>
      <td>API key does not have {read/withdraw/trade} permissions</td>
      <td>All retail APIs</td>
    </tr>
    <tr>
      <td>4005</td>
      <td>400</td>
      <td>HTTP method not supported</td>
      <td>All retail APIs</td>
    </tr>
    <tr>
      <td>4006</td>
      <td>403</td>
      <td>Signature mismatch</td>
      <td>All retail APIs</td>
    </tr>
    <tr>
      <td>4007</td>
      <td>400</td>
      <td>Timestamp older than 5 seconds</td>
      <td>All retail APIs</td>
    </tr>
    <tr>
      <td>4008</td>
      <td>403</td>
      <td>IP not whitelisted</td>
      <td>All retail APIs</td>
    </tr>
    <tr>
      <td>4009</td>
      <td>403</td>
      <td>API key rate limit exceeded (1s)</td>
      <td>v1/order/place-order</td>
    </tr>
    <tr>
      <td>4010</td>
      <td>403</td>
      <td>API key rate limit exceeded (10s)</td>
      <td>All APIs (except `place-order`)</td>
    </tr>
    <tr>
      <td>4011</td>
      <td>403</td>
      <td>API key rate limit exceeded (1m)</td>
      <td>All APIs (except `place-order`)</td>
    </tr>
    <tr>
      <td>4012</td>
      <td>500</td>
      <td>Server is under maintenance</td>
      <td>All APIs</td>
    </tr>

</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="javascript">javascript</a>
                <a href="#" data-language-name="python">python</a>
          </div>
      </div>
    </div>
  </body>
</html>
